(function(e){function t(t){for(var a,o,i=t[0],c=t[1],l=t[2],u=0,d=[];u<i.length;u++)o=i[u],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&d.push(r[o][0]),r[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);p&&p(t);while(d.length)d.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],a=!0,i=1;i<n.length;i++){var c=n[i];0!==r[c]&&(a=!1)}a&&(s.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},r={index:0},s=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var p=c;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var a=n("85ec"),r=n.n(a);r.a},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),r=(n("9e1f"),n("450d"),n("6ed5")),s=n.n(r),o=(n("46a1"),n("e5f2")),i=n.n(o),c=(n("cbb5"),n("8bbc")),l=n.n(c),p=(n("5466"),n("ecdf")),u=n.n(p),d=(n("38a0"),n("ad41")),f=n.n(d),v=(n("06f1"),n("6ac9")),m=n.n(v),y=(n("b0ee"),n("d180")),h=n.n(y),g=(n("a335"),n("c0bb")),C=n.n(g),D=(n("ae26"),n("845f")),b=n.n(D),S=(n("6611"),n("e772")),A=n.n(S),w=(n("e612"),n("dd87")),T=n.n(w),N=(n("075a"),n("72aa")),R=n.n(N),x=(n("8bd8"),n("4cb2")),V=n.n(x),I=(n("4ca3"),n("443e")),L=n.n(I),E=(n("fd71"),n("a447")),P=n.n(E),O=(n("960d"),n("defb")),_=n.n(O),M=(n("bd49"),n("18ff")),B=n.n(M),k=(n("cb70"),n("b370")),U=n.n(k),F=(n("b5c2"),n("20cf")),W=n.n(F),j=(n("3c52"),n("0d7b")),z=n.n(j),$=(n("fe07"),n("6ac5")),H=n.n($),G=(n("10cb"),n("f3ad")),J=n.n(G),q=(n("e3ea"),n("7bc3")),K=n.n(q),X=(n("eca7"),n("3787")),Y=n.n(X),Z=(n("425f"),n("4105")),Q=n.n(Z),ee=(n("f4f9"),n("c2cc")),te=n.n(ee),ne=(n("7a0f"),n("0f6c")),ae=n.n(ne),re=(n("1951"),n("eedf")),se=n.n(re),oe=(n("1f1a"),n("4e4b")),ie=n.n(oe),ce=(n("1760"),n("9883")),le=n.n(ce),pe=(n("bdc7"),n("aa2f")),ue=n.n(pe),de=(n("de31"),n("c69e")),fe=n.n(de),ve=(n("a769"),n("5cc3")),me=n.n(ve),ye=(n("a673"),n("7b31")),he=n.n(ye),ge=(n("adec"),n("3d2d")),Ce=n.n(ge),De=(n("b8e0"),n("a4c4")),be=n.n(De);a["default"].use(be.a),a["default"].use(Ce.a),a["default"].use(he.a),a["default"].use(me.a),a["default"].use(fe.a),a["default"].use(ue.a),a["default"].use(le.a),a["default"].use(ie.a),a["default"].use(se.a),a["default"].use(ae.a),a["default"].use(te.a),a["default"].use(Q.a),a["default"].use(Y.a),a["default"].use(K.a),a["default"].use(J.a),a["default"].use(H.a),a["default"].use(z.a),a["default"].use(W.a),a["default"].use(U.a),a["default"].use(B.a),a["default"].use(_.a),a["default"].use(P.a),a["default"].use(L.a),a["default"].use(V.a),a["default"].use(R.a),a["default"].use(T.a),a["default"].use(A.a),a["default"].use(b.a),a["default"].use(C.a),a["default"].use(h.a),a["default"].use(m.a),a["default"].use(f.a),a["default"].use(u.a),a["default"].use(l.a),a["default"].prototype.$notify=i.a,a["default"].prototype.$confirm=s.a.confirm;var Se=n("91cf"),Ae=n.n(Se),we=n("9274"),Te=n.n(we),Ne=(n("820a"),n("d5f6")),Re=n("f0f8"),xe=n.n(Re),Ve=n("4dd1"),Ie=n.n(Ve),Le=(n("8da8"),n("2a50")),Ee=(n("1564"),n("f718"),n("029f"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("el-container",{staticStyle:{height:"100%"}},[n("el-header",{staticStyle:{height:"70px","background-color":"#409eff",color:"#fff","padding-left":"30px","vertical-align":"middle","line-height":"70px","border-bottom":"1px solid #ddd"}},[n("span",{staticStyle:{"font-size":"20px"}},[e._v("Cassia蓝牙调试工具")]),n("span",{staticStyle:{float:"right"}},[e._v("Language "),n("el-select",{staticStyle:{width:"120px","padding-right":"15px"},attrs:{size:"small"},model:{value:e.store.devConfDisplayVars.language,callback:function(t){e.$set(e.store.devConfDisplayVars,"language",t)},expression:"store.devConfDisplayVars.language"}},[n("el-option",{attrs:{label:"中文",value:"中文"}}),n("el-option",{attrs:{label:"English",value:"English"}})],1)],1)]),n("el-container",[n("el-aside",{directives:[{name:"show",rawName:"v-show",value:this.store.devConfDisplayVars.isConfigMenuItemOpen,expression:"this.store.devConfDisplayVars.isConfigMenuItemOpen"}],staticStyle:{"border-right":"1px solid #f2f2f2"},attrs:{width:"350px"}},[n("el-container",{staticStyle:{height:"100%"}},[n("el-main",[n("el-form",{attrs:{"label-width":"80px",size:"small"}},[n("el-row",{staticStyle:{"font-size":"16px","border-bottom":"1px solid #ddd","margin-top":"30px"}},[n("span",[e._v("配置连接配置")])]),n("el-form-item",{staticStyle:{"margin-top":"15px"},attrs:{label:"连接方式"}},[n("el-select",{staticStyle:{width:"100%"},model:{value:e.store.devConf.controlStyle,callback:function(t){e.$set(e.store.devConf,"controlStyle",t)},expression:"store.devConf.controlStyle"}},[n("el-option",{attrs:{label:"ap",value:"ap"}}),n("el-option",{attrs:{label:"ac",value:"ac"}})],1)],1),n("el-form-item",{staticStyle:{"margin-top":"15px"},attrs:{label:"服务URL"}},[n("el-input",{staticClass:"server-ip",attrs:{clearable:"",placeholder:"http://192.168.0.100"},model:{value:e.store.devConf.serverURI,callback:function(t){e.$set(e.store.devConf,"serverURI",t)},expression:"store.devConf.serverURI"}})],1),n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"ac"===e.store.devConf.controlStyle,expression:"store.devConf.controlStyle === 'ac'"}],staticStyle:{"margin-top":"15px"},attrs:{label:"开发账号"}},[n("el-input",{staticClass:"ac-dev-key",model:{value:e.store.devConf.acDevKey,callback:function(t){e.$set(e.store.devConf,"acDevKey",t)},expression:"store.devConf.acDevKey"}})],1),n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"ac"===e.store.devConf.controlStyle,expression:"store.devConf.controlStyle === 'ac'"}],staticStyle:{"margin-top":"15px"},attrs:{label:"开发密码"}},[n("el-input",{staticClass:"ac-dev-secret",model:{value:e.store.devConf.acDevSecret,callback:function(t){e.$set(e.store.devConf,"acDevSecret",t)},expression:"store.devConf.acDevSecret"}})],1),n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"ac"===e.store.devConf.controlStyle,expression:"store.devConf.controlStyle === 'ac'"}],staticStyle:{"margin-top":"15px"},attrs:{label:"AP MAC"}},[n("el-input",{staticClass:"ap-mac",attrs:{placeholder:"CC:1B:E0:E0:DD:70"},model:{value:e.store.devConf.mac,callback:function(t){e.$set(e.store.devConf,"mac",t)},expression:"store.devConf.mac"}})],1),n("el-row",{staticStyle:{"font-size":"16px","border-bottom":"1px solid #ddd","margin-top":"50px"}},[n("span",[e._v("配置扫描参数")])]),n("el-form-item",{staticStyle:{"margin-top":"15px"},attrs:{label:"使用芯片"}},[n("el-select",{staticStyle:{width:"100%"},model:{value:e.store.devConf.chip,callback:function(t){e.$set(e.store.devConf,"chip",t)},expression:"store.devConf.chip"}},[n("el-option",{attrs:{label:"0",value:"0"}}),n("el-option",{attrs:{label:"1",value:"1"}})],1)],1),n("el-form-item",{staticStyle:{"margin-top":"15px"},attrs:{label:"过滤名称"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入",multiple:"",filterable:"","allow-create":"","default-first-option":""},model:{value:e.store.devConf.filter_name,callback:function(t){e.$set(e.store.devConf,"filter_name",t)},expression:"store.devConf.filter_name"}})],1),n("el-form-item",{attrs:{label:"过滤MAC"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入",multiple:"",filterable:"","allow-create":"","default-first-option":""},model:{value:e.store.devConf.filter_mac,callback:function(t){e.$set(e.store.devConf,"filter_mac",t)},expression:"store.devConf.filter_mac"}})],1),n("el-form-item",{attrs:{label:"过滤RSSI"}},[n("el-slider",{attrs:{min:-85,max:0},model:{value:e.store.devConf.filter_rssi,callback:function(t){e.$set(e.store.devConf,"filter_rssi",t)},expression:"store.devConf.filter_rssi"}})],1),n("el-form-item",[n("el-button-group",[n("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.store.devConfDisplayVars.isScanning,expression:"!store.devConfDisplayVars.isScanning"}],attrs:{type:"primary",size:"small"},on:{click:e.startScan}},[e._v("开始扫描")]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:e.store.devConfDisplayVars.isScanning,expression:"store.devConfDisplayVars.isScanning"}],attrs:{type:"danger",size:"small"},on:{click:e.stopScan}},[e._v("停止扫描")]),n("el-button",{attrs:{size:"small",type:"primary"}},[e._v("重启 AP")])],1)],1)],1)],1)],1)],1),n("el-main",{staticStyle:{"background-color":"#fff",padding:"0"}},[n("el-container",{staticStyle:{height:"100%","background-color":"#fff"}},[n("el-aside",{staticStyle:{"background-color":"#fff"},attrs:{width:"110px"}},[n("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{collapse:"","background-color":e.store.devConfDisplayVars.isConfigMenuItemOpen?"#fff":"#f5f5f5","text-color":"#fff","active-text-color":"#2897ff","default-active":"scanListMenuItem"},on:{select:e.menuSelect}},[n("el-menu-item",{attrs:{index:"configMenuItem"}},[n("i",{staticClass:"el-icon-s-fold"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("配置参数")])]),n("el-menu-item",{attrs:{index:"scanListMenuItem"}},[n("i",{staticClass:"el-icon-search"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("扫描列表")])]),n("el-menu-item",{attrs:{index:"connectListMenuItem"}},[n("i",{staticClass:"el-icon-connection"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("连接列表")])]),n("el-menu-item",{attrs:{index:"notifyListMenuItem"}},[n("i",{staticClass:"el-icon-message-solid"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("通知列表")])]),n("el-menu-item",{attrs:{index:"apiLogListMenuItem"}},[n("i",{staticClass:"el-icon-s-order"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("接口日志")])]),n("el-menu-item",{attrs:{index:"apiDebuggerMenuItem"}},[n("i",{staticClass:"el-icon-service"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("接口调试")])]),n("el-menu-item",{attrs:{index:"apiDemoMenuItem"}},[n("i",{staticClass:"el-icon-magic-stick"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("常用示例")])])],1)],1),n("el-main",{staticStyle:{height:"100%"}},[n("el-tabs",{directives:[{name:"show",rawName:"v-show",value:"scanListMenuItem"===e.store.devConfDisplayVars.activeMenuItem,expression:"store.devConfDisplayVars.activeMenuItem === 'scanListMenuItem'"}],staticStyle:{"background-color":"#fff"},on:{"tab-click":e.scanTabsClick}},[n("el-tab-pane",{staticStyle:{height:"100%","background-color":"#fff"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-s-data"}),e._v(" 扫描结果")]),n("vxe-toolbar",{scopedSlots:e._u([{key:"buttons",fn:function(){return[n("span",[e._v("扫描设备数量:"),n("span",{staticStyle:{"font-weight":"bold",color:"#409eff"}},[e._v(e._s(e.getComputedScanDisplayResultList.length)+" ")])]),n("vxe-input",{attrs:{type:"search",placeholder:"搜索mac或name",size:"small"},model:{value:e.cache.scanDisplayFilterContent,callback:function(t){e.$set(e.cache,"scanDisplayFilterContent",t)},expression:"cache.scanDisplayFilterContent"}}),n("vxe-button",{attrs:{status:"danger",size:"small"},on:{click:e.scanDisplayResultClear}},[e._v("清空")]),n("vxe-button",{attrs:{status:"primary",size:"small"},on:{click:e.scanDisplayResultExport}},[e._v("导出")])]},proxy:!0}])}),n("vxe-grid",{ref:"refScanDisplayResultGrid",attrs:{border:"none","show-overflow":"",stripe:"","highlight-hover-row":"",height:"560px","sort-config":{trigger:"cell"},data:e.getComputedScanDisplayResultList}},[n("vxe-table-column",{attrs:{field:"name",title:"NAME",type:"html",width:"25%",sortable:""}}),n("vxe-table-column",{attrs:{field:"mac",title:"MAC",type:"html",width:"30%","show-overflow":""}}),n("vxe-table-column",{attrs:{field:"bdaddrType",title:"类型",width:"15%",sortable:""}}),n("vxe-table-column",{attrs:{field:"rssi",title:"信号",width:"15%",sortable:""}}),n("vxe-table-column",{attrs:{title:"操作",width:"15%"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("vxe-button",{attrs:{status:"primary",size:"small",loading:e.cache.devicesConnectLoading[a.mac]},on:{click:function(t){return e.connectDeviceByRow(a,a.mac)}}},[e._v("连接")])]}}])})],1)],1),n("el-tab-pane",{staticStyle:{width:"100%"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-pie-chart"}),e._v(" RSSI图表")]),n("el-row",[n("el-form",{attrs:{inline:"",size:"small"}},[n("el-form-item",{attrs:{label:"统计周期"}},[n("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"统计周期"},model:{value:e.store.devConfDisplayVars.rssiChartPeriod,callback:function(t){e.$set(e.store.devConfDisplayVars,"rssiChartPeriod",t)},expression:"store.devConfDisplayVars.rssiChartPeriod"}},[n("el-option",{attrs:{label:"60秒",value:"60"}})],1)],1),n("el-form-item",{attrs:{label:"统计间隔"}},[n("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"统计间隔"},on:{change:e.rssiChartDataSpanChange},model:{value:e.store.devConfDisplayVars.rssiChartDataSpan,callback:function(t){e.$set(e.store.devConfDisplayVars,"rssiChartDataSpan",t)},expression:"store.devConfDisplayVars.rssiChartDataSpan"}},[n("el-option",{attrs:{label:"200毫秒",value:"200"}}),n("el-option",{attrs:{label:"500毫秒",value:"500"}}),n("el-option",{attrs:{label:"1秒",value:"1000"}}),n("el-option",{attrs:{label:"2秒",value:"2000"}}),n("el-option",{attrs:{label:"5秒",value:"5000"}}),n("el-option",{attrs:{label:"10秒",value:"10000"}}),n("el-option",{attrs:{label:"30秒",value:"30000"}})],1)],1),n("el-form-item",[n("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.store.devConfDisplayVars.rssiChartSwitch,expression:"!store.devConfDisplayVars.rssiChartSwitch"}],attrs:{size:"small",type:"primary"},on:{click:e.destoryAndCreateRssiChart}},[e._v("开启")]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:e.store.devConfDisplayVars.rssiChartSwitch&&!e.store.devConfDisplayVars.rssiChartStopped,expression:"store.devConfDisplayVars.rssiChartSwitch && !store.devConfDisplayVars.rssiChartStopped"}],attrs:{size:"small",type:"primary"},on:{click:e.stopRssiChart}},[e._v("暂停")]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:e.store.devConfDisplayVars.rssiChartSwitch&&e.store.devConfDisplayVars.rssiChartStopped,expression:"store.devConfDisplayVars.rssiChartSwitch && store.devConfDisplayVars.rssiChartStopped"}],attrs:{size:"small",type:"primary"},on:{click:e.startRssiChart}},[e._v("继续")]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:e.store.devConfDisplayVars.rssiChartSwitch,expression:"store.devConfDisplayVars.rssiChartSwitch"}],attrs:{size:"small",type:"primary"},on:{click:e.destoryRssiChart}},[e._v("关闭")])],1)],1)],1),n("v-chart",{ref:"rssiChart",staticStyle:{width:"100%",height:"500px"},attrs:{options:e.chartOptions,autoresize:!0}})],1)],1),n("el-tabs",{directives:[{name:"show",rawName:"v-show",value:"connectListMenuItem"===e.store.devConfDisplayVars.activeMenuItem,expression:"store.devConfDisplayVars.activeMenuItem === 'connectListMenuItem'"}],attrs:{closable:""},on:{"tab-remove":e.connectedListTabRemove},model:{value:e.cache.currentConnectedTab,callback:function(t){e.$set(e.cache,"currentConnectedTab",t)},expression:"cache.currentConnectedTab"}},[n("el-tab-pane",[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-s-data"}),e._v(" 连接列表")]),n("vxe-toolbar",{scopedSlots:e._u([{key:"buttons",fn:function(){return[n("span",[e._v("连接设备数量:"),n("span",{staticStyle:{"font-weight":"bold",color:"#409eff"}},[e._v(e._s(e.getComputedConnectDisplayResultList().length)+" ")])]),n("vxe-input",{attrs:{type:"search",placeholder:"搜索mac或name",size:"small"},model:{value:e.cache.connectDisplayFilterContent,callback:function(t){e.$set(e.cache,"connectDisplayFilterContent",t)},expression:"cache.connectDisplayFilterContent"}}),n("vxe-button",{attrs:{status:"primary",size:"small"},on:{click:e.connectDisplayResultExport}},[e._v("导出")])]},proxy:!0}])}),n("vxe-grid",{ref:"refConnectDisplayResultGrid",attrs:{border:"none","show-overflow":"",stripe:"","highlight-hover-row":"",height:"560px","sort-config":{trigger:"cell"},data:e.getComputedConnectDisplayResultList()}},[n("vxe-table-column",{attrs:{field:"name",title:"名称",type:"html",width:"15%",sortable:""}}),n("vxe-table-column",{attrs:{field:"mac",title:"地址",type:"html",width:"20%","show-overflow":""}}),n("vxe-table-column",{attrs:{field:"chip",title:"芯片",type:"html",width:"15%",sortable:""}}),n("vxe-table-column",{attrs:{field:"bdaddrType",title:"类型",width:"15%",sortable:""}}),n("vxe-table-column",{attrs:{title:"操作",width:"35%"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-button-group",[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.getDeviceServices(a.mac)}}},[e._v("服务")]),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.disconnectDevice(a.mac)}}},[e._v("断连")]),n("el-button",{attrs:{type:"primary",size:"small"}},[e._v("配对")]),n("el-button",{attrs:{type:"primary",size:"small"}},[e._v("取消配对")]),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.exportDeviceServices(e.device.mac)}}},[e._v("导出")])],1)]}}])})],1)],1),e._l(e.cache.connectedList,(function(t,a){return n("el-tab-pane",{key:t.mac,attrs:{name:t.mac}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-connection"}),e._v(" "+e._s(t.mac))]),n("el-row",{staticStyle:{"background-color":"#409eff","font-size":"14px","font-style":"normal","border-radius":"3px",color:"#fff",height:"60px",display:"flex","align-items":"center","padding-left":"15px","padding-right":"15px"}},[n("el-col",{attrs:{span:6}},[n("el-row",[e._v(e._s(t.name))]),n("el-row",{staticStyle:{"font-style":"normal"}},[e._v(e._s(t.mac))])],1),n("el-col",{attrs:{span:3}},[e._v(e._s(t.bdaddrType))]),n("el-col",{attrs:{span:3}},[e._v("chip"+e._s(t.chip))]),n("el-col",{attrs:{span:12}},[n("el-button-group",{staticStyle:{float:"right"}},[n("el-button",{staticStyle:{color:"#2897ff"},attrs:{size:"small"},on:{click:function(n){return e.getDeviceServices(t.mac)}}},[e._v("服务")]),n("el-button",{staticStyle:{color:"#2897ff"},attrs:{size:"small"},on:{click:function(n){return e.disconnectDevice(t.mac)}}},[e._v("断连")]),n("el-button",{staticStyle:{color:"#2897ff"},attrs:{size:"small"}},[e._v("配对")]),n("el-button",{staticStyle:{color:"#2897ff"},attrs:{size:"small"}},[e._v("取消配对")]),n("el-button",{staticStyle:{color:"#2897ff"},attrs:{size:"small"},on:{click:function(n){return e.exportDeviceServices(t.mac)}}},[e._v("导出")])],1)],1)],1),n("el-row",{staticStyle:{"padding-left":"0px","margin-top":"15px"}},[n("el-collapse",e._l(e.cache.devicesServiceList[t.mac],(function(a,r){return n("el-collapse-item",{key:a.uuid},[n("template",{slot:"title"},[n("el-col",{staticStyle:{"padding-left":"5px","font-size":"14px","font-style":"normal"}},[e._v(e._s(a.uuid))]),n("el-col",{staticStyle:{float:"right","font-size":"14px","font-style":"normal"}},[e._v(e._s(a.name))])],1),e._l(a.characteristics,(function(a,r){return n("el-row",{key:a.uuid,staticStyle:{"background-color":"#e6e6e6",padding:"15px","border-bottom":"1px solid #fff"},attrs:{title:"char.name"}},[n("el-row",{staticStyle:{"font-size":"14px","font-weight":"bold","font-style":"normal"}},[e._v(e._s(a.name))]),n("el-row",{staticStyle:{"font-size":"12px","font-style":"normal"}},[e._v("UUID: "+e._s(a.uuid))]),n("el-row",{staticStyle:{"font-size":"12px","font-style":"normal"}},[e._v("HANDLE: "+e._s(a.handle))]),n("el-row",{staticStyle:{"font-size":"12px","font-style":"normal"}},[e._v(" Properties: "),n("el-button-group",[n("el-button",{directives:[{name:"show",rawName:"v-show",value:a.propertiesStr.includes("READ"),expression:"char.propertiesStr.includes('READ')"}],staticStyle:{"font-style":"normal","font-weight":"bold"},attrs:{type:"primary",size:"small"},on:{click:function(n){return e.propertyClick("READ",t.mac,a)}}},[e._v(" READ ")]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:a.propertiesStr.includes("NOTIFY"),expression:"char.propertiesStr.includes('NOTIFY')"}],staticStyle:{"font-style":"normal","font-weight":"bold"},attrs:{type:"on"===a.notifyStatus?"primary":"info",size:"small"},on:{click:function(n){return e.propertyClick("NOTIFY",t.mac,a)}}},[e._v(" NOTIFY ")]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:a.propertiesStr.includes("WRITE NO RES"),expression:"char.propertiesStr.includes('WRITE NO RES')"}],staticStyle:{"font-style":"normal","font-weight":"bold"},attrs:{type:"primary",size:"small"},on:{click:function(n){return e.propertyClick("WRITE NO RES",t.mac,a)}}},[e._v(" WRITE NO RES ")]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:a.propertiesStr.includes("WRITE"),expression:"char.propertiesStr.includes('WRITE')"}],staticStyle:{"font-style":"normal","font-weight":"bold"},attrs:{type:"primary",size:"small"},on:{click:function(n){return e.propertyClick("WRITE",t.mac,a)}}},[e._v(" WRITE ")])],1),n("el-radio-group",{directives:[{name:"show",rawName:"v-show",value:a.propertiesStr.includes("WRITE")||a.propertiesStr.includes("WRITE NO RES"),expression:"char.propertiesStr.includes('WRITE') || char.propertiesStr.includes('WRITE NO RES')"}],staticStyle:{float:"right"},attrs:{size:"small"},model:{value:a.writeValueType,callback:function(t){e.$set(a,"writeValueType",t)},expression:"char.writeValueType"}},[n("el-radio-button",{attrs:{label:"hex"}},[e._v("HEX")]),n("el-radio-button",{attrs:{label:"text"}},[e._v("TEXT")])],1),n("el-input",{directives:[{name:"show",rawName:"v-show",value:a.propertiesStr.includes("WRITE")||a.propertiesStr.includes("WRITE NO RES"),expression:"char.propertiesStr.includes('WRITE') || char.propertiesStr.includes('WRITE NO RES')"}],staticStyle:{width:"220px",float:"right","font-size":"12px","font-style":"normal"},attrs:{size:"small",placeholder:"hex"===a.writeValueType?"格式：aa00bb11cc22（支持空格）":"格式：任意字符"},model:{value:a.writeValue,callback:function(t){e.$set(a,"writeValue",t)},expression:"char.writeValue"}})],1),n("el-row",{directives:[{name:"show",rawName:"v-show",value:0!==a.readValue.toString().length,expression:"char.readValue.toString().length !== 0"}],staticStyle:{"font-size":"12px","font-style":"normal",color:"#409eff"}},[e._v(" Value: (0x) "),n("el-popover",{attrs:{trigger:"click",width:"600",placement:"right"}},[n("el-table",{attrs:{data:a.parsedReadValues,width:"100%",stripe:"","empty-text":"暂未添加解析"}},[n("el-table-column",{attrs:{label:"字段",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.name))])]}}],null,!0)}),n("el-table-column",{attrs:{label:"解析",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.parsed))])]}}],null,!0)}),n("el-table-column",{attrs:{label:"HEX(0x)",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.raw))])]}}],null,!0)})],1),n("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v(" "+e._s(a.readValue)+" ")])],1)],1)],1)}))],2)})),1)],1)],1)}))],2),n("el-tabs",{directives:[{name:"show",rawName:"v-show",value:"notifyListMenuItem"===e.store.devConfDisplayVars.activeMenuItem,expression:"store.devConfDisplayVars.activeMenuItem === 'notifyListMenuItem'"}]},[n("el-tab-pane",[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-connection"}),e._v(" 通知列表")]),n("el-row",[n("vxe-toolbar",{scopedSlots:e._u([{key:"buttons",fn:function(){return[n("span",[e._v("设备通知数量:"),n("span",{staticStyle:{"font-weight":"bold",color:"#409eff"}},[e._v(e._s(e.getComputedNotifyDisplayResultList.length)+" ")])]),n("vxe-input",{attrs:{type:"search",placeholder:"搜索mac",size:"small"},model:{value:e.cache.notifyDisplayFilterContent,callback:function(t){e.$set(e.cache,"notifyDisplayFilterContent",t)},expression:"cache.notifyDisplayFilterContent"}}),n("vxe-button",{directives:[{name:"show",rawName:"v-show",value:!e.store.devConfDisplayVars.isNotifyOn,expression:"!store.devConfDisplayVars.isNotifyOn"}],attrs:{status:"primary",size:"small"},on:{click:e.openNotify}},[e._v("开启")]),n("vxe-button",{directives:[{name:"show",rawName:"v-show",value:e.store.devConfDisplayVars.isNotifyOn,expression:"store.devConfDisplayVars.isNotifyOn"}],attrs:{status:"danger",size:"small"},on:{click:e.closeNotify}},[e._v("关闭")]),n("vxe-button",{attrs:{status:"danger",size:"small"},on:{click:e.notifyDisplayResultClear}},[e._v("清空")]),n("vxe-button",{attrs:{status:"primary",size:"small"},on:{click:e.notifyDisplayResultExport}},[e._v("导出")])]},proxy:!0}])}),n("vxe-grid",{ref:"refNotifyDisplayResultGrid",attrs:{border:"none","show-overflow":"",stripe:"",height:"560px","highlight-hover-row":"","sort-config":{trigger:"cell"},data:e.getComputedNotifyDisplayResultList}},[n("vxe-table-column",{attrs:{field:"time",title:"时间戳",type:"html",width:"20%",sortable:""}}),n("vxe-table-column",{attrs:{field:"mac",title:"地址",type:"html",width:"30%","show-overflow":""}}),n("vxe-table-column",{attrs:{field:"handle",title:"HANDLE",width:"10%"}}),n("vxe-table-column",{attrs:{field:"value",title:"VALUE",width:"40%","show-overflow":""}})],1)],1)],1)],1),n("el-tabs",{directives:[{name:"show",rawName:"v-show",value:"apiDebuggerMenuItem"===e.store.devConfDisplayVars.activeMenuItem,expression:"store.devConfDisplayVars.activeMenuItem === 'apiDebuggerMenuItem'"}],model:{value:e.store.devConfDisplayVars.activeApiTabName,callback:function(t){e.$set(e.store.devConfDisplayVars,"activeApiTabName",t)},expression:"store.devConfDisplayVars.activeApiTabName"}},[n("el-tab-pane",{attrs:{name:"scan"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-search"}),e._v(" 扫描设备")]),n("el-form",{staticStyle:{"margin-top":"15px"},attrs:{"label-width":"80px",size:"small"}},[n("el-form-item",{attrs:{label:"使用芯片"}},[n("el-radio-group",{attrs:{size:"small"},model:{value:e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName].chip,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName],"chip",t)},expression:"store.devConfDisplayVars.apiDebuggerParams[store.devConfDisplayVars.activeApiTabName].chip"}},[n("el-radio-button",{attrs:{label:0}},[e._v("芯片0")]),n("el-radio-button",{attrs:{label:1}},[e._v("芯片1")])],1)],1),n("el-form-item",{attrs:{label:"过滤名称"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入",multiple:"",filterable:"","allow-create":"","default-first-option":""},model:{value:e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName].filter_name,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName],"filter_name",t)},expression:"store.devConfDisplayVars.apiDebuggerParams[store.devConfDisplayVars.activeApiTabName].filter_name"}})],1),n("el-form-item",{attrs:{label:"过滤MAC"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入",multiple:"",filterable:"","allow-create":"","default-first-option":""},model:{value:e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName].filter_mac,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName],"filter_mac",t)},expression:"store.devConfDisplayVars.apiDebuggerParams[store.devConfDisplayVars.activeApiTabName].filter_mac"}})],1),n("el-form-item",{attrs:{label:"过滤RSSI"}},[n("el-slider",{attrs:{"show-input":"",min:-85,max:0},model:{value:e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName].filter_rssi,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName],"filter_rssi",t)},expression:"store.devConfDisplayVars.apiDebuggerParams[store.devConfDisplayVars.activeApiTabName].filter_rssi"}})],1),n("el-form-item",{attrs:{align:"left"}},[n("el-button-group",[n("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.store.devConfDisplayVars.isApiScanning,expression:"!store.devConfDisplayVars.isApiScanning"}],attrs:{type:"primary",size:"small"},on:{click:e.startDebugApi}},[e._v("开始调试")]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:e.store.devConfDisplayVars.isApiScanning,expression:"store.devConfDisplayVars.isApiScanning"}],attrs:{type:"danger",size:"small"},on:{click:e.stopApiScan}},[e._v("停止扫描")]),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.genCode}},[e._v("生成代码")])],1)],1)],1)],1),n("el-tab-pane",{attrs:{name:"connect"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-connection"}),e._v(" 连接设备")]),n("el-form",{staticStyle:{"margin-top":"15px"},attrs:{"label-width":"80px",size:"small"}},[n("el-form-item",{attrs:{label:"使用芯片"}},[n("el-radio-group",{attrs:{size:"small"},model:{value:e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName].chip,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName],"chip",t)},expression:"store.devConfDisplayVars.apiDebuggerParams[store.devConfDisplayVars.activeApiTabName].chip"}},[n("el-radio-button",{attrs:{label:"0"}},[e._v("芯片0")]),n("el-radio-button",{attrs:{label:"1"}},[e._v("芯片1")])],1)],1),n("el-form-item",{attrs:{label:"地址类型"}},[n("el-radio-group",{attrs:{size:"small"},model:{value:e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName].addrType,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName],"addrType",t)},expression:"store.devConfDisplayVars.apiDebuggerParams[store.devConfDisplayVars.activeApiTabName].addrType"}},[n("el-radio-button",{attrs:{label:"public"}},[e._v("PUBLIC")]),n("el-radio-button",{attrs:{label:"random"}},[e._v("RANDOM")])],1)],1),n("el-form-item",{attrs:{label:"设备地址"}},[n("el-input",{model:{value:e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName].deviceMac,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName],"deviceMac",t)},expression:"store.devConfDisplayVars.apiDebuggerParams[store.devConfDisplayVars.activeApiTabName].deviceMac"}})],1),n("el-form-item",{attrs:{align:"left"}},[n("el-button-group",[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.startDebugApi}},[e._v("开始调试")]),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.genCode}},[e._v("生成代码")])],1)],1)],1)],1),n("el-tab-pane",{attrs:{name:"read"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-reading"}),e._v(" 读取数据")]),n("el-form",{staticStyle:{"margin-top":"15px"},attrs:{"label-width":"80px",size:"small"}},[n("el-form-item",{attrs:{label:"HANDLE"}},[n("el-input",{model:{value:e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName].handle,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName],"handle",t)},expression:"store.devConfDisplayVars.apiDebuggerParams[store.devConfDisplayVars.activeApiTabName].handle"}})],1),n("el-form-item",{attrs:{label:"设备地址"}},[n("el-input",{model:{value:e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName].deviceMac,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName],"deviceMac",t)},expression:"store.devConfDisplayVars.apiDebuggerParams[store.devConfDisplayVars.activeApiTabName].deviceMac"}})],1),n("el-form-item",{attrs:{align:"left"}},[n("el-button-group",[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.startDebugApi}},[e._v("开始调试")]),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.genCode}},[e._v("生成代码")])],1)],1)],1)],1),n("el-tab-pane",{attrs:{name:"write"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-edit-outline"}),e._v(" 写入数据")]),n("el-form",{staticStyle:{"margin-top":"15px"},attrs:{"label-width":"80px",size:"small"}},[n("el-form-item",{attrs:{label:"HANDLE"}},[n("el-input",{model:{value:e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName].handle,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName],"handle",t)},expression:"store.devConfDisplayVars.apiDebuggerParams[store.devConfDisplayVars.activeApiTabName].handle"}})],1),n("el-form-item",{attrs:{label:"VALUE"}},[n("el-input",{model:{value:e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName].value,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName],"value",t)},expression:"store.devConfDisplayVars.apiDebuggerParams[store.devConfDisplayVars.activeApiTabName].value"}})],1),n("el-form-item",{attrs:{label:"写入方式"}},[n("el-radio-group",{attrs:{size:"small"},model:{value:e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName].noresponse,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName],"noresponse",t)},expression:"store.devConfDisplayVars.apiDebuggerParams[store.devConfDisplayVars.activeApiTabName].noresponse"}},[n("el-radio-button",{attrs:{label:"false"}},[e._v("等待")]),n("el-radio-button",{attrs:{label:"true"}},[e._v("不等待")])],1)],1),n("el-form-item",{attrs:{label:"设备地址"}},[n("el-input",{model:{value:e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName].deviceMac,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName],"deviceMac",t)},expression:"store.devConfDisplayVars.apiDebuggerParams[store.devConfDisplayVars.activeApiTabName].deviceMac"}})],1),n("el-form-item",{attrs:{align:"left"}},[n("el-button-group",[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.startDebugApi}},[e._v("开始调试")]),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.genCode}},[e._v("生成代码")])],1)],1)],1)],1),n("el-tab-pane",{attrs:{name:"disconnect"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-scissors"}),e._v(" 断开连接")]),n("el-form",{staticStyle:{"margin-top":"15px"},attrs:{"label-width":"80px",size:"small"}},[n("el-form-item",{attrs:{label:"设备地址"}},[n("el-input",{model:{value:e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName].deviceMac,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDebuggerParams[e.store.devConfDisplayVars.activeApiTabName],"deviceMac",t)},expression:"store.devConfDisplayVars.apiDebuggerParams[store.devConfDisplayVars.activeApiTabName].deviceMac"}})],1),n("el-form-item",{attrs:{align:"left"}},[n("el-button-group",[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.startDebugApi}},[e._v("开始调试")]),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.genCode}},[e._v("生成代码")])],1)],1)],1)],1)],1),n("el-tabs",{directives:[{name:"show",rawName:"v-show",value:"apiDebuggerMenuItem"===e.store.devConfDisplayVars.activeMenuItem,expression:"store.devConfDisplayVars.activeMenuItem === 'apiDebuggerMenuItem'"}],model:{value:e.store.devConfDisplayVars.activeApiOutputTabName,callback:function(t){e.$set(e.store.devConfDisplayVars,"activeApiOutputTabName",t)},expression:"store.devConfDisplayVars.activeApiOutputTabName"}},[n("el-tab-pane",{attrs:{name:"output"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-circle-check"}),e._v(" 调试结果")]),"scan"===e.store.devConfDisplayVars.activeApiTabName?n("highlight-code",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadApiDebuggerResult,expression:"loadApiDebuggerResult"}],attrs:{lang:"javascript","infinite-scroll-distance":"20px","infinite-scroll-disabled":e.cache.isApiDebuggerLoading}},[e._v(" "+e._s(e.cache.apiDebuggerResult[e.store.devConfDisplayVars.activeApiTabName].displayResultList.join("\n"))+" ")]):e._e(),"scan"!==e.store.devConfDisplayVars.activeApiTabName?n("highlight-code",{attrs:{lang:"javascript"}},[e._v(" "+e._s(e.cache.apiDebuggerResult[e.store.devConfDisplayVars.activeApiTabName].resultList.join("\n"))+" ")]):e._e()],1),n("el-tab-pane",{attrs:{name:"curl"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" cURL代码")]),n("highlight-code",{attrs:{lang:"bash"}},[e._v(" "+e._s(e.cache.apiDebuggerResult[e.store.devConfDisplayVars.activeApiTabName].code["curl"])+" ")])],1),n("el-tab-pane",{attrs:{name:"nodejs"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" NodeJS代码")]),n("highlight-code",{attrs:{lang:"js"}},[e._v(" "+e._s(e.cache.apiDebuggerResult[e.store.devConfDisplayVars.activeApiTabName].code["nodejs"])+" ")])],1)],1),n("el-tabs",{directives:[{name:"show",rawName:"v-show",value:"apiLogListMenuItem"===e.store.devConfDisplayVars.activeMenuItem,expression:"store.devConfDisplayVars.activeMenuItem === 'apiLogListMenuItem'"}]},[n("el-tab-pane",[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-connection"}),e._v(" 接口日志")]),n("el-row",[n("vxe-toolbar",{scopedSlots:e._u([{key:"buttons",fn:function(){return[n("span",[e._v("接口日志数量:"),n("span",{staticStyle:{"font-weight":"bold",color:"#409eff"}},[e._v(e._s(e.getComputedApiLogDisplayResultList().length)+" ")])]),n("vxe-input",{attrs:{type:"search",placeholder:"搜索",size:"small"},model:{value:e.cache.apiLogDisplayFilterContent,callback:function(t){e.$set(e.cache,"apiLogDisplayFilterContent",t)},expression:"cache.apiLogDisplayFilterContent"}}),n("vxe-button",{attrs:{status:"danger",size:"small"},on:{click:e.apiLogDisplayResultClear}},[e._v("清空")]),n("vxe-button",{attrs:{status:"primary",size:"small"},on:{click:e.apiLogDisplayResultExport}},[e._v("导出")])]},proxy:!0}])}),n("vxe-grid",{ref:"refApiLogDisplayResultGrid",attrs:{border:"none",stripe:"",height:"560px","highlight-hover-row":"","sort-config":{trigger:"cell"},data:e.getComputedApiLogDisplayResultList()}},[n("vxe-table-column",{attrs:{field:"timeStr",title:"时间",type:"html",width:"25%",sortable:""}}),n("vxe-table-column",{attrs:{field:"apiName",title:"接口名称",type:"html",width:"15%",sortable:""}}),n("vxe-table-column",{attrs:{field:"apiContentJson",title:"请求内容",type:"html",width:"60%",sortable:""}})],1)],1)],1)],1),n("el-tabs",{directives:[{name:"show",rawName:"v-show",value:"apiDemoMenuItem"===e.store.devConfDisplayVars.activeMenuItem,expression:"store.devConfDisplayVars.activeMenuItem === 'apiDemoMenuItem'"}]},[n("el-tab-pane",[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-connection"}),e._v(" [单设备]建连->写入->通知")]),n("el-card",{attrs:{shadow:"hover"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("1.连接设备")]),n("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.apiDemoConnectTest}},[e._v("测试")])],1),n("el-form",{attrs:{"label-width":"80px",size:"small"}},[n("el-form-item",{attrs:{label:"历史接口"}},[n("el-select",{staticStyle:{width:"100%"},on:{change:e.apiDemoConnectChanged},model:{value:e.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.connect.tempFromApiLogUrl,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.connect,"tempFromApiLogUrl",t)},expression:"store.devConfDisplayVars.apiDemoParams.connectWriteNotify.connect.tempFromApiLogUrl"}},e._l(e.getApiLogListByFilter({apiName:"连接设备"}),(function(e,t){return n("el-option",{key:t,attrs:{label:e.apiContentJson,value:e.apiContentJson}})})),1)],1),n("el-form-item",{attrs:{label:"使用芯片"}},[n("el-radio-group",{attrs:{size:"small"},model:{value:e.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.connect.chip,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.connect,"chip",t)},expression:"store.devConfDisplayVars.apiDemoParams.connectWriteNotify.connect.chip"}},[n("el-radio-button",{attrs:{label:"0"}},[e._v("芯片0")]),n("el-radio-button",{attrs:{label:"1"}},[e._v("芯片1")])],1)],1),n("el-form-item",{attrs:{label:"地址类型"}},[n("el-radio-group",{attrs:{size:"small"},model:{value:e.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.connect.addrType,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.connect,"addrType",t)},expression:"store.devConfDisplayVars.apiDemoParams.connectWriteNotify.connect.addrType"}},[n("el-radio-button",{attrs:{label:"public"}},[e._v("PUBLIC")]),n("el-radio-button",{attrs:{label:"random"}},[e._v("RANDOM")])],1)],1),n("el-form-item",{attrs:{label:"设备地址"}},[n("el-input",{model:{value:e.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.connect.deviceMac,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.connect,"deviceMac",t)},expression:"store.devConfDisplayVars.apiDemoParams.connectWriteNotify.connect.deviceMac"}})],1)],1)],1),n("el-card",{staticStyle:{"margin-top":"15px"},attrs:{shadow:"hover"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("2.写入指令")]),n("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.apiDemoWriteTest}},[e._v("测试")])],1),n("el-form",{attrs:{"label-width":"80px",size:"small"}},[n("el-form-item",{attrs:{label:"历史接口"}},[n("el-select",{staticStyle:{width:"100%"},on:{change:e.apiDemoWriteChanged},model:{value:e.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.write.tempFromApiLogUrl,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.write,"tempFromApiLogUrl",t)},expression:"store.devConfDisplayVars.apiDemoParams.connectWriteNotify.write.tempFromApiLogUrl"}},e._l(e.getApiLogListByFilter({apiName:"写入数据"}),(function(e,t){return n("el-option",{key:t,attrs:{label:e.apiContentJson,value:e.apiContentJson}})})),1)],1),n("el-form-item",{attrs:{label:"HANDLE"}},[n("el-input",{model:{value:e.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.write.handle,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.write,"handle",t)},expression:"store.devConfDisplayVars.apiDemoParams.connectWriteNotify.write.handle"}})],1),n("el-form-item",{attrs:{label:"VALUE"}},[n("el-input",{model:{value:e.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.write.value,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.write,"value",t)},expression:"store.devConfDisplayVars.apiDemoParams.connectWriteNotify.write.value"}})],1),n("el-form-item",{attrs:{label:"写入方式"}},[n("el-radio-group",{attrs:{size:"small"},model:{value:e.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.write.noresponse,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.write,"noresponse",t)},expression:"store.devConfDisplayVars.apiDemoParams.connectWriteNotify.write.noresponse"}},[n("el-radio-button",{attrs:{label:"false"}},[e._v("等待")]),n("el-radio-button",{attrs:{label:"true"}},[e._v("不等待")])],1)],1)],1)],1),n("el-card",{staticStyle:{"margin-top":"15px"},attrs:{shadow:"hover"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("3.接收通知")])]),n("el-form",{attrs:{"label-width":"80px",size:"small"}},[n("span",{staticStyle:{"font-size":"12px"}},[e._v("通过SSE接收数据")])])],1),n("el-button-group",{staticStyle:{"margin-top":"15px"}},[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.apiDemoConnectWriteNotifyGenCode}},[e._v("生成代码")]),n("el-button",{attrs:{type:"primary",size:"small"}},[e._v("清空数据")])],1),n("highlight-code",{attrs:{lang:"javascript"}},[e._v(" "+e._s(e.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.code)+" ")])],1),n("el-tab-pane",[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-connection"}),e._v(" [多设备]扫描->建连->写入")]),n("el-card",{attrs:{shadow:"hover"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("1.扫描设备")]),n("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.apiDemoScanTest}},[e._v("测试")])],1),n("el-form",{staticStyle:{"margin-top":"15px"},attrs:{"label-width":"80px",size:"small"}},[n("el-form-item",{attrs:{label:"历史接口"}},[n("el-select",{staticStyle:{width:"100%"},on:{change:e.apiDemoScanChanged},model:{value:e.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.scan.tempFromApiLogUrl,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.scan,"tempFromApiLogUrl",t)},expression:"store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.scan.tempFromApiLogUrl"}},e._l(e.getApiLogListByFilter({apiName:"扫描设备"}),(function(e,t){return n("el-option",{key:t,attrs:{label:e.apiContentJson,value:e.apiContentJson}})})),1)],1),n("el-form-item",{attrs:{label:"使用芯片"}},[n("el-radio-group",{attrs:{size:"small"},model:{value:e.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.scan.chip,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.scan,"chip",t)},expression:"store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.scan.chip"}},[n("el-radio-button",{attrs:{label:0}},[e._v("芯片0")]),n("el-radio-button",{attrs:{label:1}},[e._v("芯片1")])],1)],1),n("el-form-item",{attrs:{label:"过滤名称"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入",multiple:"",filterable:"","allow-create":"","default-first-option":""},model:{value:e.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.scan.filter_name,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.scan,"filter_name",t)},expression:"store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.scan.filter_name"}})],1),n("el-form-item",{attrs:{label:"过滤MAC"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入",multiple:"",filterable:"","allow-create":"","default-first-option":""},model:{value:e.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.scan.filter_mac,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.scan,"filter_mac",t)},expression:"store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.scan.filter_mac"}})],1),n("el-form-item",{attrs:{label:"过滤RSSI"}},[n("el-slider",{attrs:{"show-input":"",min:-85,max:0},model:{value:e.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.scan.filter_rssi,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.scan,"filter_rssi",t)},expression:"store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.scan.filter_rssi"}})],1)],1)],1),n("el-card",{staticStyle:{"margin-top":"15px"},attrs:{shadow:"hover"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("2.连接设备")])]),n("el-form",{attrs:{"label-width":"80px",size:"small"}},[n("span",{staticStyle:{"font-size":"12px"}},[e._v("连接扫描到的设备")])])],1),n("el-card",{staticStyle:{"margin-top":"15px"},attrs:{shadow:"hover"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("3.写入指令")])]),n("el-form",{attrs:{"label-width":"80px",size:"small"}},[n("el-form-item",{attrs:{label:"历史接口"}},[n("el-select",{staticStyle:{width:"100%"},on:{change:e.apiDemoWriteChanged},model:{value:e.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.write.tempFromApiLogUrl,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.write,"tempFromApiLogUrl",t)},expression:"store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.write.tempFromApiLogUrl"}},e._l(e.getApiLogListByFilter({apiName:"写入数据"}),(function(e,t){return n("el-option",{key:t,attrs:{label:e.apiContentJson,value:e.apiContentJson}})})),1)],1),n("el-form-item",{attrs:{label:"HANDLE"}},[n("el-input",{model:{value:e.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.write.handle,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.write,"handle",t)},expression:"store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.write.handle"}})],1),n("el-form-item",{attrs:{label:"VALUE"}},[n("el-input",{model:{value:e.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.write.value,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.write,"value",t)},expression:"store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.write.value"}})],1),n("el-form-item",{attrs:{label:"写入方式"}},[n("el-radio-group",{attrs:{size:"small"},model:{value:e.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.write.noresponse,callback:function(t){e.$set(e.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.write,"noresponse",t)},expression:"store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.write.noresponse"}},[n("el-radio-button",{attrs:{label:"false"}},[e._v("等待")]),n("el-radio-button",{attrs:{label:"true"}},[e._v("不等待")])],1)],1)],1)],1),n("el-card",{staticStyle:{"margin-top":"15px"},attrs:{shadow:"hover"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("4.接收通知")])]),n("el-form",{attrs:{"label-width":"80px",size:"small"}},[n("span",{staticStyle:{"font-size":"12px"}},[e._v("通过SSE接收数据")])])],1),n("el-button-group",{staticStyle:{"margin-top":"15px"}},[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.apiDemoScanConnectWriteNotifyGenCode}},[e._v("生成代码")]),n("el-button",{attrs:{type:"primary",size:"small"}},[e._v("清空数据")])],1),n("highlight-code",{attrs:{lang:"javascript"}},[e._v(" "+e._s(e.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.code)+" ")])],1)],1)],1)],1)],1)],1)],1)],1)}),Pe=[],Oe=(n("99af"),n("4de4"),n("7db0"),n("c740"),n("4160"),n("c975"),n("a15b"),n("d81d"),n("45fc"),n("a434"),n("b0c0"),n("d3b7"),n("4d63"),n("ac1f"),n("25f0"),n("3ca3"),n("5319"),n("498a"),n("159b"),n("ddb0"),n("2b3d"),n("2909")),_e=(n("caad"),n("2532"),n("82ae")),Me=n.n(_e);function Be(e){return{debug:console.log.bind(this,"[".concat(e,"]")),info:console.log.bind(this,"[".concat(e,"]")),warn:console.log.bind(this,"[".concat(e,"]")),error:console.log.bind(this,"[".concat(e,"]"))}}var ke={genModuleLogger:Be},Ue={AC:"ac",AP:"ap"},Fe={BROADCASTS:"BROADCASTS",READ:"READ",WRITE_NO_RES:"WRITE NO RES",WRITE:"WRITE",NOTIFY:"NOTIFY",INDICATE:"INDICATE",AUTHEN:"AUTHEN",EXTENDED:"EXTENDED"},We={ON:"on",OFF:"off"},je={INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error"},ze={HEX:"hex",TEXT:"text"},$e={SCAN:"scan",CONNECT:"connect",READ:"read",WRITE:"write",DISCONNECT:"disconnect"},He={CURL:"curl",NODEJS:"nodejs"},Ge={PUBLIC:"public",RANDOM:"random"},Je={operation:Fe,controlStyle:Ue,notifyStatus:We,messageType:je,writeDataType:ze,apiType:$e,codeType:He,deviceAddrType:Ge},qe={http:{requestTimeout:5e3}},Ke=qe,Xe={http:{requestTimeout:1e3}},Ye=Xe,Ze=Ke;"production"===window.ENV&&(Ze=Ye);var Qe=Ze;n("fb6a"),n("1276");function et(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode("0x"+t)})))}function tt(e){return decodeURIComponent(atob(e).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))}var nt,at,rt,st,ot,it,ct,lt={encode:et,decode:tt},pt=n("ade3"),ut=n("2ef0"),dt=ke.genModuleLogger("db"),ft="storageKey",vt={devConfSaveTimer:null,accessToken:"",devConf:{controlStyle:Je.controlStyle.AP,serverURI:"http://192.168.5.100",baseURI:"http://192.168.5.100",acDevKey:"cassia",acDevSecret:"cassia",mac:"CC:1B:E0:E0:DD:70",filter_name:[],filter_mac:[],filter_rssi:-75,chip:0},devConfDisplayVars:{language:"中文",mainWidth:18,isConfigMenuItemOpen:!0,scanFilterNamesInputVisible:!1,scanFilterNamesInputValue:"",scanFilterMacsInputVisible:!1,scanFilterMacsInputValue:"",apiScanFilterNamesInputVisible:!1,apiScanFilterNamesInputValue:"",apiScanFilterMacsInputVisible:!1,apiScanFilterMacsInputValue:"",isScanning:!1,isNotifyOn:!1,isApiScanResultDisplayOn:!0,isApiScanning:!1,apiOutputDisplayCount:20,activeMenuItem:"scanListMenuItem",activeApiTabName:"scan",activeApiDemoTabName:"connectWriteNotify",activeApiOutputTabName:"output",rssiChartStopped:!1,rssiChartSwitch:!1,rssiChartPeriod:60,rssiChartDataSpan:2e3,rssiChartDataCount:30,apiDebuggerParams:(nt={},Object(pt["a"])(nt,Je.apiType.SCAN,{chip:0,filter_name:[],filter_mac:[],filter_rssi:-65}),Object(pt["a"])(nt,Je.apiType.CONNECT,{chip:0,deviceMac:"C0:00:5B:D1:AA:BC",addrType:Je.deviceAddrType.PUBLIC}),Object(pt["a"])(nt,Je.apiType.READ,{deviceMac:"C0:00:5B:D1:AA:BC",handle:"39"}),Object(pt["a"])(nt,Je.apiType.WRITE,{deviceMac:"C0:00:5B:D1:AA:BC",handle:"39",value:"21ff310302ff31",noresponse:!1}),Object(pt["a"])(nt,Je.apiType.DISCONNECT,{deviceMac:"C0:00:5B:D1:AA:BC"}),nt),apiDemoParams:{connectWriteNotify:{connect:{tempFromApiLogUrl:"",chip:0,deviceMac:"C0:00:5B:D1:AA:BC",addrType:Je.deviceAddrType.PUBLIC},write:{tempFromApiLogUrl:"",handle:39,value:"21ff310302ff31",noresponse:!1},code:""},scanConnectWriteNotify:{scan:{tempFromApiLogUrl:"",chip:0,filter_name:[],filter_mac:[],filter_rssi:-75},write:{tempFromApiLogUrl:"",handle:39,value:"21ff310302ff31",noresponse:!1},code:""}}}},mt=Object(pt["a"])({currentConnectedTab:"0",scanDisplayFilterContent:"",connectDisplayFilterContent:"",notifyDisplayFilterContent:"",apiLogDisplayFilterContent:"",isApiDebuggerLoading:!1,isNotifyLoading:!1,devicesConnectLoading:{},apiDebuggerResult:(ct={},Object(pt["a"])(ct,Je.apiType.SCAN,{sse:null,resultList:[{time:1582882186095,data:'{"name":"(unknown)","evtType":3,"rssi":-80,"adData":"1EFF06000109200262A12A0E18F1516C3D7DABD42556C51B45E9094EB88D2B","bdaddrs":[{"bdaddr":"76:95:9B:89:BB:A5","bdaddrType":"random"}]}'}],displayResultList:[],code:(at={},Object(pt["a"])(at,Je.codeType.CURL,""),Object(pt["a"])(at,Je.codeType.NODEJS,""),at)}),Object(pt["a"])(ct,Je.apiType.CONNECT,{resultList:[],code:(rt={},Object(pt["a"])(rt,Je.codeType.CURL,""),Object(pt["a"])(rt,Je.codeType.NODEJS,""),rt)}),Object(pt["a"])(ct,Je.apiType.READ,{resultList:[],code:(st={},Object(pt["a"])(st,Je.codeType.CURL,""),Object(pt["a"])(st,Je.codeType.NODEJS,""),st)}),Object(pt["a"])(ct,Je.apiType.WRITE,{resultList:[],code:(ot={},Object(pt["a"])(ot,Je.codeType.CURL,""),Object(pt["a"])(ot,Je.codeType.NODEJS,""),ot)}),Object(pt["a"])(ct,Je.apiType.DISCONNECT,{resultList:[],code:(it={},Object(pt["a"])(it,Je.codeType.CURL,""),Object(pt["a"])(it,Je.codeType.NODEJS,""),it)}),ct),scanResultList:[],notifyDisplayResultList:[],apiLogResultList:[{timestamp:Date.now(),timeStr:"2020-03-10T02:48:41.235",apiName:"扫描设备",apiContentJson:"",apiContent:{url:"http://192.168.5.105/gap/nodes/?mac=&access_token=&active=1&event=1&chip=0",method:"GET",headers:{},data:{body:{},params:{},query:{}}}}],scanDisplayResultList:[],scanDevicesRssiHistory:{},connectedList:[],devicesServiceList:{},notifyResultList:[]},"notifyDisplayResultList",[]);function yt(e,t){window.localStorage.setItem(e,t)}function ht(e){return window.localStorage.getItem(e)}function gt(e){var t=e.serverURI;return e.controlStyle===Je.controlStyle.AC&&(t+="/api"),t}function Ct(e){e.baseURI=gt(e),vt.devConf=e,yt(ft,JSON.stringify(vt))}function Dt(e){return e.baseURI=gt(e),vt.devConf=e,new Promise((function(t,n){Nn.getAccessToken(e.baseURI,e.acDevKey,e.acDevSecret).then((function(e){vt.accessToken=e.access_token,yt(ft,JSON.stringify(vt)),t()})).catch((function(e){n(e)}))}))}function bt(e){clearTimeout(vt.devConfSaveTimer),vt.devConfSaveTimer=setTimeout((function(){return dt.info("save dev conf:",e),e.controlStyle===Je.controlStyle.AC?Dt(e):Ct(e)}),1e3)}function St(){return vt.devConf}function At(){return vt.devConfDisplayVars}function wt(){return mt}function Tt(){return vt}function Nt(){vt=JSON.parse(ht(ft))||vt}function Rt(e,t,n){var a=ut.find(e,t);a?ut.forEach(n,(function(e,t){a[t]=e})):e.push(n)}var xt={save:yt,get:ht,saveDevConf:bt,getDevConf:St,storage:vt,cache:mt,loadStorage:Nt,getCache:wt,getStorage:Tt,getDevConfDisplayVars:At,listAddOrUpdate:Rt},Vt=n("2ef0"),It=ke.genModuleLogger("api");function Lt(e){var t=[];return Vt.forEach(e,(function(e,n){Vt.isArray(e)&&(e=e.join(",")),t.push("".concat(n,"=").concat(e))})),t.join("&")}function Et(e){return void 0!==e&&null!==e&&(!Vt.isArray(e)||0!==e.length)}function Pt(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a={};return Vt.forEach(e,(function(e,n){Vt.includes(t,n)&&Et(e)&&(a[n]=e)})),e.controlStyle===Je.controlStyle.AC&&(a.mac=e.mac,n&&(a.access_token=xt.getStorage().accessToken)),a}function Ot(e,t,n){var a="".concat(e,"/oauth2/token"),r={grant_type:"client_credentials"},s={Authorization:"Basic "+lt.encode("".concat(t,":").concat(n))},o=Me.a.create({timeout:Qe.http.requestTimeout,headers:s});return mn("请求令牌","POST",a,{},r,{},s),new Promise((function(e,t){o.post(a,r).then((function(t){It.info("get access token success:",t),e(t.data)})).catch((function(e){It.error("get access token error:",e),t(e)}))}))}function _t(e){}function Mt(e){It.error("scan sse error:",e)}function Bt(e,t){return"".concat(e,"/gap/nodes?").concat(Lt(t))}function kt(e,t){return"".concat(e,"/gatt/nodes?").concat(Lt(t))}function Ut(e,t,n){return"".concat(e,"/gap/nodes/").concat(t,"/connection?").concat(Lt(n))}function Ft(e,t){return"".concat(e,"/gap/multi-connect?").concat(Lt(t))}function Wt(e,t,n,a){return"".concat(e,"/gatt/nodes/").concat(t,"/handle/").concat(n,"/value?").concat(Lt(a))}function jt(e,t,n,a,r){return"".concat(e,"/gatt/nodes/").concat(t,"/handle/").concat(n,"/value/").concat(a,"?").concat(Lt(r))}function zt(e,t,n){return"".concat(e,"/gap/nodes/").concat(t,"/connection?").concat(Lt(n))}function $t(e,t){return"".concat(e,"/management/nodes/connection-state?").concat(Lt(t))}function Ht(e,t,n){var a=new EventSource(e);return a.onmessage=t||_t,a.onerror=n||Mt,It.info("open scan sse:",e),a}function Gt(e){It.info("connect status sse message:",e)}function Jt(e){It.error("connect status sse error:",e)}function qt(e,t,n){var a=new EventSource(e);return a.onmessage=t||Gt,a.onerror=n||Jt,It.info("connect status sse:",e),a}function Kt(e){It.info("notify sse message:",e)}function Xt(e){It.error("notify sse error:",e)}function Yt(e,t,n,a){var r="".concat(e,"/gatt/nodes?").concat(Lt(t));mn("打开通知","GET/SSE",r,t);var s=new EventSource(r);return s.onmessage=n||Kt,s.onerror=a||Xt,It.info("open notify sse:",r),s}function Zt(e,t,n,a){var r="".concat(e,"/gap/nodes/").concat(n,"/connection/?").concat(Lt(t)),s={timeout:Qe.http.requestTimeout,type:a};return mn("连接设备","POST",r,t,s,{deviceMac:n}),new Promise((function(e,t){Me.a.post(r,s).then((function(t){It.info("connect device success:",t),e(t.data)})).catch((function(e){var n=e.response?e.response.data:e;It.error("connect device error:",n),t(n)}))}))}function Qt(e,t,n){var a="".concat(e,"/gap/nodes/").concat(n,"/connection/?").concat(Lt(t));return mn("断开设备","DELETE",a,t,{},{deviceMac:n}),new Promise((function(e,t){Me.a.delete(a).then((function(t){It.info("disconnect device success:",t),e(t.data)})).catch((function(e){var n=e.response?e.response.data:e;It.error("disconnect device error:",n),t(n)}))}))}function en(e,t){var n="".concat(e,"/gap/nodes?").concat(Lt(t),"&connection_state=connected");return mn("连接列表","GET",n,t),new Promise((function(e,t){Me.a.get(n).then((function(t){It.info("get connected list success:",t),e(t.data)})).catch((function(e){var n=e.response?e.response.data:e;It.error("get connected list error:",n),t(n)}))}))}function tn(e,t,n){var a="".concat(e,"/gatt/nodes/").concat(n,"/services/characteristics/descriptors?").concat(Lt(t));return mn("服务列表","GET",a,t,{},{deviceMac:n}),new Promise((function(e,t){Me.a.get(a).then((function(t){It.info("get device service list success:",t),e(t.data)})).catch((function(e){var n=e.response?e.response.data:e;It.error("get device service list error:",n),t(n)}))}))}function nn(e,t,n,a){var r="".concat(e,"/gatt/nodes/").concat(n,"/handle/").concat(a,"/value?").concat(Lt(t));return mn("读取数据","GET",r,t,{},{deviceMac:n}),new Promise((function(e,t){Me.a.get(r).then((function(t){It.info("read handle success:",t),e(t.data)})).catch((function(e){var n=e.response?e.response.data:e;It.error("read handle error:",n),t(n)}))}))}function an(e,t,n,a,r){var s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];s&&(t.noresponse=1);var o="".concat(e,"/gatt/nodes/").concat(n,"/handle/").concat(a,"/value/").concat(r,"?").concat(Lt(t));return mn("写入数据","GET",o,t,{},{deviceMac:n,handle:a,value:r}),new Promise((function(e,t){Me.a.get(o).then((function(t){It.info("write handle success:",t),e(t.data)})).catch((function(e){var n=e.response?e.response.data:e;It.error("write handle error:",n),t(n)}))}))}function rn(e,t,n){var a=[],r=Pt(e,a);return Wt(e.baseURI,t,n,r)}function sn(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=[],r=Pt(e,a,n);return zt(e.baseURI,t,r)}function on(e,t,n,a,r){var s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o=[],i=Pt(e,o,s);return r&&(i.noresponse=1),jt(e.baseURI,t,n,a,i)}function cn(e,t,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=[],s=Pt(e,r,a);return 0!==+n&&1!==+n||(s.chip=n),Ut(e.baseURI,t,s)}function ln(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=[],a=Pt(e,n,t);return Ft(e.baseURI,a)}function pn(e){var t=["chip","filter_mac","filter_name","filter_rssi"],n=Pt(e,t);return n.active=1,n.event=1,Bt(e.baseURI,n)}function un(e,t,n,a,r){var s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o=Vt.cloneDeep(e);o.chip=t,o.filter_mac=n,o.filter_name=a,o.filter_rssi=r;var i=["chip","filter_mac","filter_name","filter_rssi"],c=Pt(o,i,s);return c.active=1,c.event=1,Bt(e.baseURI,c)}function dn(e){var t="".concat(e.baseURI,"/oauth2/token");return t}function fn(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=[],a=Pt(e,n,t);return a.event=1,kt(e.baseURI,a)}function vn(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=[],a=Pt(e,n,t);return $t(e.baseURI,a)}function mn(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},i=Date.now(),c={url:n,method:t,data:{}};Vt.isEmpty(o)||(c.headers=o),Vt.isEmpty(a)||(c.data.query=a),Vt.isEmpty(r)||(c.data.body=r),Vt.isEmpty(s)||(c.data.params=s),xt.cache.apiLogResultList.push({timestamp:i,timeStr:new Date(i).toISOString(),apiName:e,apiContent:c,apiContentJson:JSON.stringify(c)})}function yn(e,t,n){var a=["chip","filter_mac","filter_name","filter_rssi"],r=Pt(e,a);r.active=1,r.event=1;var s="".concat(e.baseURI,"/gap/nodes?").concat(Lt(r));return mn("扫描设备","GET/SSE",s,r),Ht(s,t,n)}function hn(e,t,n,a,r,s,o){var i=Vt.cloneDeep(e);return i.chip=t,i.filter_mac=n,i.filter_name=a,i.filter_rssi=r,yn(i,s,o)}function gn(e,t,n){var a=vn(e);return mn("连接事件","GET/SSE",a,""),qt(a,t,n)}function Cn(e,t,n){var a=[],r=Pt(e,a);return r.event=1,Yt(e.baseURI,r,t,n)}function Dn(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=Pt(e,[]),s=xt.getCache().scanDisplayResultList;if(!n){var o=Vt.find(s,{mac:t});if(!o)return Promise.reject("can not get addr type");n=o.bdaddrType}return 0!==+a&&1!==+a||(r.chip=a),Zt(e.baseURI,r,t,n)}function bn(e){var t=Pt(e,[]);return en(e.baseURI,t)}function Sn(e,t){var n=Pt(e,[]);return Qt(e.baseURI,n,t)}function An(e,t){var n=Pt(e,[]);return tn(e.baseURI,n,t)}function wn(e,t,n){var a=Pt(e,[]);return nn(e.baseURI,a,t,n)}function Tn(e,t,n,a,r){var s=Pt(e,[]);return an(e.baseURI,s,t,n,a,r)}Me.a.defaults.headers["Content-Type"]="application/json";var Nn={getAccessToken:Ot,startScanByDevConf:yn,startNotifyByDevConf:Cn,connectByDevConf:Dn,disconnectByDevConf:Sn,getConnectedListByDevConf:bn,getDeviceServiceListByDevConf:An,readByHandleByDevConf:wn,writeByHandleByDevConf:Tn,getScanUrlByDevConf:pn,openConnectStatusSseByDevConf:gn,getConnectUrlByDevConf:cn,getReadUrlByDevConf:rn,getWriteUrlByDevConf:on,getDisconnectUrlByDevConf:sn,startScanByUserParams:hn,getNotifyUrlByDevConf:fn,getOauth2UrlByDevConf:dn,getScanUrlByUserParams:un,getAsyncConnectUrlByDevConf:ln,getConnectStatusUrlByDevConf:vn},Rn=n("2ef0"),xn=ke.genModuleLogger("scan"),Vn=null;function In(e){var t=xt.getCache(),n=xt.getStorage(),a=JSON.parse(e.data),r=a.bdaddrs[0],s=r.bdaddr,o=r.bdaddrType,i=Rn.find(t.scanResultList,{mac:s});i?("(unknown)"!==a.name&&(i.name=a.name),i.rssi=a.rssi):t.scanResultList.push({mac:s,name:a.name,adData:a.adData,bdaddrType:o,rssi:a.rssi}),n.devConfDisplayVars.rssiChartSwitch&&(t.scanDevicesRssiHistory[s]?t.scanDevicesRssiHistory[s].push({time:Date.now(),rssi:a.rssi}):is.setObjProperty(t.scanDevicesRssiHistory,s,[{time:Date.now(),rssi:a.rssi}]))}function Ln(e){xn.error("scan sse error:",e),Yr.notify("停止扫描，扫描SSE异常: ".concat(e.message||JSON.stringify(e)),"服务异常",Je.messageType.ERROR),Vn.close(),Vn=null}function En(e){return Vn||(Vn=Nn.startScanByDevConf(e,In,Ln),Vn)}function Pn(){Vn&&(Vn.close(),Vn=null),Yr.notify("停止扫描成功","操作成功",Je.messageType.SUCCESS)}var On={startScan:En,stopScan:Pn},_n=(n("2ca0"),{1800:"Generic Access",1811:"Alert Notification Service",1815:"Automation IO","180F":"Battery Service","183B":"Binary Sensor",1810:"Blood Pressure","181B":"Body Composition","181E":"Bond Management Service","181F":"Continuous Glucose Monitoring",1805:"Current Time Service",1818:"Cycling Power",1816:"Cycling Speed and Cadence","180A":"Device Information","183C":"Emergency Configuration","181A":"Environmental Sensing",1826:"Fitness Machine",1801:"Generic Attribute",1808:"Glucose",1809:"Health Thermometer","180D":"Heart Rate",1823:"HTTP Proxy",1812:"Human Interface Device",1802:"Immediate Alert",1821:"Indoor Positioning","183A":"Insulin Delivery",1820:"Internet Protocol Support Service",1803:"Link Loss",1819:"Location and Navigation",1827:"Mesh Provisioning Service",1828:"Mesh Proxy Service",1807:"Next DST Change Service",1825:"Object Transfer Service","180E":"Phone Alert Status Service",1822:"Pulse Oximeter Service",1829:"Reconnection Configuration",1806:"Reference Time Update Service",1814:"Running Speed and Cadence",1813:"Scan Parameters",1824:"Transport Discovery",1804:"User Data","181D":"Weight Scale"});function Mn(e){var t=parseInt(e.split("-")[0],16).toString(16).toUpperCase();return _n[t]||"Unknown Service"}var Bn={getNameByUuid:Mn},kn={"2A7E":"Aerobic Heart Rate Lower Limit","2A84":"Aerobic Heart Rate Upper Limit","2A7F":"Aerobic Threshold","2A80":"Age","2A5A":"Aggregate","2A43":"Alert Category ID","2A42":"Alert Category ID Bit Mask","2A06":"Alert Level","2A44":"Alert Notification Control Point","2A3F":"Alert Status","2AB3":"Altitude","2A81":"Anaerobic Heart Rate Lower Limit","2A82":"Anaerobic Heart Rate Upper Limit","2A83":"Anaerobic Threshold","2A58":"Analog","2A59":"Analog Output","2A73":"Apparent Wind Direction","2A72":"Apparent Wind Speed","2A01":"Appearance","2AA3":"Barometric Pressure Trend","2A19":"Battery Level","2A1B":"Battery Level State","2A1A":"Battery Power State","2A49":"Blood Pressure Feature","2A35":"Blood Pressure Measurement","2A9B":"Body Composition Feature","2A9C":"Body Composition Measurement","2A38":"Body Sensor Location","2AA4":"Bond Management Control Point","2AA5":"Bond Management Features","2A22":"Boot Keyboard Input Report","2A32":"Boot Keyboard Output Report","2A33":"Boot Mouse Input Report","2B2B":"BSS Control Point","2B2C":"BSS Response","2AA8":"CGM Feature","2AA7":"CGM Measurement","2AAB":"CGM Session Run Time","2AAA":"CGM Session Start Time","2AAC":"CGM Specific Ops Control Point","2AA9":"CGM Status","2B29":"Client Supported Features","2ACE":"Cross Trainer Data","2A5C":"CSC Feature","2A5B":"CSC Measurement","2A2B":"Current Time","2A66":"Cycling Power Control Point","2A65":"Cycling Power Feature","2A63":"Cycling Power Measurement","2A64":"Cycling Power Vector","2A99":"Database Change Increment","2B2A":"Database Hash","2A85":"Date of Birth","2A86":"Date of Threshold Assessment","2A08":"Date Time","2AED":"Date UTC","2A0A":"Day Date Time","2A09":"Day of Week","2A7D":"Descriptor Value Changed","2A7B":"Dew Point","2A56":"Digital","2A57":"Digital Output","2A0D":"DST Offset","2A6C":"Elevation","2A87":"Email Address","2B2D":"Emergency ID","2B2E":"Emergency Text","2A0B":"Exact Time 100","2A0C":"Exact Time 256","2A88":"Fat Burn Heart Rate Lower Limit","2A89":"Fat Burn Heart Rate Upper Limit","2A26":"Firmware Revision String","2A8A":"First Name","2AD9":"Fitness Machine Control Point","2ACC":"Fitness Machine Feature","2ADA":"Fitness Machine Status","2A8B":"Five Zone Heart Rate Limits","2AB2":"Floor Number","2AA6":"Central Address Resolution","2A00":"Device Name","2A04":"Peripheral Preferred Connection Parameters","2A02":"Peripheral Privacy Flag","2A03":"Reconnection Address","2A05":"Service Changed","2A8C":"Gender","2A51":"Glucose Feature","2A18":"Glucose Measurement","2A34":"Glucose Measurement Context","2A74":"Gust Factor","2A27":"Hardware Revision String","2A39":"Heart Rate Control Point","2A8D":"Heart Rate Max","2A37":"Heart Rate Measurement","2A7A":"Heat Index","2A8E":"Height","2A4C":"HID Control Point","2A4A":"HID Information","2A8F":"Hip Circumference","2ABA":"HTTP Control Point","2AB9":"HTTP Entity Body","2AB7":"HTTP Headers","2AB8":"HTTP Status Code","2ABB":"HTTPS Security","2A6F":"Humidity","2B22":"IDD Annunciation Status","2B25":"IDD Command Control Point","2B26":"IDD Command Data","2B23":"IDD Features","2B28":"IDD History Data","2B27":"IDD Record Access Control Point","2B21":"IDD Status","2B20":"IDD Status Changed","2B24":"IDD Status Reader Control Point","2A2A":"IEEE 11073-20601 Regulatory Certification Data List","2AD2":"Indoor Bike Data","2AAD":"Indoor Positioning Configuration","2A36":"Intermediate Cuff Pressure","2A1E":"Intermediate Temperature","2A77":"Irradiance","2AA2":"Language","2A90":"Last Name","2AAE":"Latitude","2A6B":"LN Control Point","2A6A":"LN Feature","2AB1":"Local East Coordinate","2AB0":"Local North Coordinate","2A0F":"Local Time Information","2A67":"Location and Speed Characteristic","2AB5":"Location Name","2AAF":"Longitude","2A2C":"Magnetic Declination","2AA0":"Magnetic Flux Density – 2D","2AA1":"Magnetic Flux Density – 3D","2A29":"Manufacturer Name String","2A91":"Maximum Recommended Heart Rate","2A21":"Measurement Interval","2A24":"Model Number String","2A68":"Navigation","2A3E":"Network Availability","2A46":"New Alert","2AC5":"Object Action Control Point","2AC8":"Object Changed","2AC1":"Object First-Created","2AC3":"Object ID","2AC2":"Object Last-Modified","2AC6":"Object List Control Point","2AC7":"Object List Filter","2ABE":"Object Name","2AC4":"Object Properties","2AC0":"Object Size","2ABF":"Object Type","2ABD":"OTS Feature","2A5F":"PLX Continuous Measurement Characteristic","2A60":"PLX Features","2A5E":"PLX Spot-Check Measurement","2A50":"PnP ID","2A75":"Pollen Concentration","2A2F":"Position 2D","2A30":"Position 3D","2A69":"Position Quality","2A6D":"Pressure","2A4E":"Protocol Mode","2A62":"Pulse Oximetry Control Point","2A78":"Rainfall","2B1D":"RC Feature","2B1E":"RC Settings","2B1F":"Reconnection Configuration Control Point","2A52":"Record Access Control Point","2A14":"Reference Time Information","2B37":"Registered User Characteristic","2A3A":"Removable","2A4D":"Report","2A4B":"Report Map","2AC9":"Resolvable Private Address Only","2A92":"Resting Heart Rate","2A40":"Ringer Control point","2A41":"Ringer Setting","2AD1":"Rower Data","2A54":"RSC Feature","2A53":"RSC Measurement","2A55":"SC Control Point","2A4F":"Scan Interval Window","2A31":"Scan Refresh","2A3C":"Scientific Temperature Celsius","2A10":"Secondary Time Zone","2A5D":"Sensor Location","2A25":"Serial Number String","2B3A":"Server Supported Features","2A3B":"Service Required","2A28":"Software Revision String","2A93":"Sport Type for Aerobic and Anaerobic Thresholds","2AD0":"Stair Climber Data","2ACF":"Step Climber Data","2A3D":"String","2AD7":"Supported Heart Rate Range","2AD5":"Supported Inclination Range","2A47":"Supported New Alert Category","2AD8":"Supported Power Range","2AD6":"Supported Resistance Level Range","2AD4":"Supported Speed Range","2A48":"Supported Unread Alert Category","2A23":"System ID","2ABC":"TDS Control Point","2A6E":"Temperature","2A1F":"Temperature Celsius","2A20":"Temperature Fahrenheit","2A1C":"Temperature Measurement","2A1D":"Temperature Type","2A94":"Three Zone Heart Rate Limits","2A12":"Time Accuracy","2A15":"Time Broadcast","2A13":"Time Source","2A16":"Time Update Control Point","2A17":"Time Update State","2A11":"Time with DST","2A0E":"Time Zone","2AD3":"Training Status","2ACD":"Treadmill Data","2A71":"True Wind Direction","2A70":"True Wind Speed","2A95":"Two Zone Heart Rate Limit","2A07":"Tx Power Level","2AB4":"Uncertainty","2A45":"Unread Alert Status","2AB6":"URI","2A9F":"User Control Point","2A9A":"User Index","2A76":"UV Index","2A96":"VO2 Max","2A97":"Waist Circumference","2A98":"Weight","2A9D":"Weight Measurement","2A9E":"Weight Scale Feature","2A79":"Wind Chill"};function Un(e){var t=parseInt(e.split("-")[0],16).toString(16).toUpperCase();return kn[t]||"Unknown Characteristics"}var Fn={getNameByUuid:Un},Wn=n("2ef0");function jn(e){var t=[Je.operation.BROADCASTS,Je.operation.READ,Je.operation.WRITE_NO_RES,Je.operation.WRITE,Je.operation.NOTIFY,Je.operation.INDICATE,Je.operation.AUTHEN,Je.operation.EXTENDED],n=[];return Wn.forEach(t,(function(t,a){1<<a&e&&n.push(t)})),n}function zn(e){return Wn.forEach(e,(function(e){e.name=Bn.getNameByUuid(e.uuid),Wn.forEach(e.characteristics,(function(e){if(e.name=Fn.getNameByUuid(e.uuid),e.propertiesStr=jn(e.properties),Wn.includes(e.propertiesStr,Je.operation.NOTIFY)){var t=Wn.find(e.descriptors,(function(e){return e.uuid.startsWith("00002902")}));t&&(e.notifyHandle=t.handle)}e.readValue="",e.writeValue="",e.notifyStatus=Je.notifyStatus.OFF,e.writeValueType=Je.writeDataType.HEX}))})),e}function $n(e){var t=xt.getDevConf(),n=xt.getCache();return new Promise((function(a,r){Nn.getDeviceServiceListByDevConf(t,e).then((function(t){var r=Wn.cloneDeep(t);is.setObjProperty(n.devicesServiceList,e,zn(t)),a(r)})).catch((function(e){return r(e)}))}))}function Hn(e,t){for(var n=xt.getCache(),a=n.devicesServiceList[e],r=0;r<a.length;r++){var s=a[r];s.characteristics=s.characteristics||[];for(var o=0;o<s.characteristics.length;o++){var i=s.characteristics[o];if(i.handle===t)return i}}return null}var Gn={getCharByHandle:Hn,getDeviceServiceList:$n},Jn=n("b639"),qn=n.n(Jn),Kn=ke.genModuleLogger("characteristic-parser"),Xn={"Device Name":Na,Appearance:xa,"Peripheral Preferred Connection Parameters":Va,"Service Changed":Ia,"Model Number String":Ta,"Serial Number String":wa,"Hardware Revision String":Aa,"Firmware Revision String":Sa,"Software Revision String":ba,"System ID":Da,"PnP ID":Ca,"New Alert":ha,"Alert Notification Control Point":va,"Current Time":ua,"Date Time":pa,"Day Date Time":ca,"Day of Week":ia,"Exact Time 256":sa,"Manufacturer Name String":ra,"IEEE 11073-20601 Regulatory Certification Data List":aa,"Body Sensor Location":na,"Battery Level":Qn,"Alert Level":Zn},Yn={0:"No Alert",1:"Mild Alert",2:"High Alert"};function Zn(e){var t=[];try{var n=Jn["Buffer"].from(e,"hex"),a=n.readUInt8(0);t.push({name:"Level",raw:n.slice(0,1).toString("hex"),parsed:Yn[a]||"Reserved"})}catch(r){Kn.error(r)}return t}function Qn(e){var t=[];try{var n=Jn["Buffer"].from(e,"hex"),a=n.readUInt8(0);t.push({name:"Level",raw:n.slice(0,1).toString("hex"),parsed:"".concat(a,"%, [0, 100]")})}catch(r){Kn.error(r)}return t}var ea={0:"Other",1:"Chest",2:"Wrist",3:"Finger",4:"Hand",5:"Ear Lobe",6:"Foot"};function ta(e){return e>=7&&e<=255?"ReservedForFutureUse":ea[e]||e}function na(e){var t=[];try{var n=Jn["Buffer"].from(e,"hex"),a=n.readUInt8(0);t.push({name:"Body Sensor Location",raw:n.slice(0,1).toString("hex"),parsed:ta(a)})}catch(r){Kn.error(r)}return t}function aa(e){var t=[];try{Jn["Buffer"].from(e,"hex")}catch(n){Kn.error(n)}return t}function ra(e){var t=[];try{var n=Jn["Buffer"].from(e,"hex");t.push({name:"Manufacturer Name",raw:e,parsed:n.toString()})}catch(a){Kn.error(a)}return t}function sa(e){var t=[];try{var n=Jn["Buffer"].from(e,"hex"),a=ca(n.slice(0,8).toString("hex"));t.splice.apply(t,[0,a.length].concat(Object(Oe["a"])(a)));var r=n.readUInt8(8,9);t.push({name:"Fractions256",raw:n.slice(8,9).toString("hex"),parsed:"".concat(r,", [0, 255]")})}catch(s){Kn.error(s)}return t}var oa={0:"Day of week is not known",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday",7:"Sunday"};function ia(e){var t=[];try{var n=Jn["Buffer"].from(e,"hex"),a=n.readUInt8();t.push({name:"Day of Week",raw:n.slice(0,1).toString("hex"),parsed:oa[a]})}catch(r){Kn.error(r)}return t}function ca(e){var t=[];try{var n=Jn["Buffer"].from(e,"hex"),a=pa(n.slice(0,7).toString("hex"));t.splice.apply(t,[0,a.length].concat(Object(Oe["a"])(a)));var r=ia(n.slice(7,8).toString("hex"));t.splice.apply(t,[t.length,r.length].concat(Object(Oe["a"])(r)))}catch(s){Kn.error(s)}return t}var la={0:"Month is not known",1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"};function pa(e){var t=[];try{var n=Jn["Buffer"].from(e,"hex"),a=n.readUInt16LE(0,2);t.push({name:"Year",raw:n.slice(0,2).toString("hex"),parsed:0===a?"Year is not known":"".concat(a,", [1582, 9999]")});var r=n.readUInt8(2);t.push({name:"Month",raw:n.slice(2,3).toString("hex"),parsed:la[r]});var s=n.readUInt8(3);t.push({name:"Day",raw:n.slice(3,4).toString("hex"),parsed:0===s?"Day of Month is not known":s});var o=n.readUInt8(4);t.push({name:"Hours",raw:n.slice(4,5).toString("hex"),parsed:o});var i=n.readUInt8(5);t.push({name:"Minutes",raw:n.slice(5,6).toString("hex"),parsed:i});var c=n.readUInt8(6);t.push({name:"Seconds",raw:n.slice(6,7).toString("hex"),parsed:c})}catch(l){Kn.error(l)}return t}function ua(e){var t=[];try{var n=Jn["Buffer"].from(e,"hex"),a=sa(n.slice(0,9).toString("hex"));t.splice.apply(t,[0,a.length].concat(Object(Oe["a"])(a)))}catch(r){Kn.error(r)}return t}var da={0:"Enable New Incoming Alert Notification",1:"Enable Unread Category Status Notification",2:"Disable New Incoming Alert Notification",3:"Disable Unread Category Status Notification",4:"Notify New Incoming Alert immediately",5:"Notify Unread Category Status immediately"};function fa(e){return e>=6&&e<=255?"ReservedForFutureUse":da[e]||e}function va(e){var t=[];try{var n=Jn["Buffer"].from(e,"hex"),a=n.readUInt8();t.push({name:"Command ID",raw:n.slice(0,1).toString("hex"),parsed:fa(a)});var r=n.readUInt8(1);t.push({name:"Category ID",raw:n.slice(1,2).toString("hex"),parsed:ya(r)})}catch(s){Kn.error(s)}return t}var ma={0:"Simple Alert: General text alert or non-text alert",1:"Email: Alert when Email messages arrives",2:"News: News feeds such as RSS, Atom",3:"Call: Incoming call",4:"Missed call: Missed Call",5:"SMS/MMS: SMS/MMS message arrives",6:"Voice mail: Voice mail",7:"Schedule: Alert occurred on calendar, planner",8:"High Prioritized Alert: Alert that should be handled as high priority",9:"Instant Message: Alert for incoming instant messages"};function ya(e){return e>=10&&e<=250?"ReservedForFutureUse":e>=251&&e<=255?"DefinedByServiceSpecification":ma[e]}function ha(e){var t=[];try{var n=Jn["Buffer"].from(e,"hex"),a=n.readUInt8();t.push({name:"Category ID",raw:n.slice(0,1).toString("hex"),parsed:ya(a)});var r=n.readUInt8(1);t.push({name:"Number of New Alert",raw:n.slice(1,2),parsed:"".concat(r,", [0, 255]")});var s=n.slice(2);t.push({name:"Text String Information",raw:s.toString("hex"),parsed:s.toString()})}catch(o){Kn.error(o)}return t}var ga={1:"Bluetooth SIG assigned Company Identifier value from the Assigned Numbers document",2:"USB Implementer’s Forum assigned Vendor ID value"};function Ca(e){var t=[];try{var n=Jn["Buffer"].from(e,"hex"),a=n.readUInt8(0);t.push({name:"Vendor ID Source",raw:n.slice(0,1).toString("hex"),parsed:ga[a]||"".concat(a,", [1, 2]")});var r=n.readUInt16LE(1);t.push({name:"Vendor ID",raw:n.slice(1,3).toString("hex"),parsed:r});var s=n.readUInt16LE(3);t.push({name:"Product ID",raw:n.slice(3,5).toString("hex"),parsed:s});var o=n.readUInt16LE(5);t.push({name:"Product Version",raw:n.slice(5,7).toString("hex"),parsed:o})}catch(i){Kn.error(i)}return t}function Da(e){Jn["Buffer"].from(e,"hex");return[]}function ba(e){return[{name:"Software Revision",raw:e,parsed:Jn["Buffer"].from(e,"hex").toString()}]}function Sa(e){return[{name:"Firmware Revision",raw:e,parsed:Jn["Buffer"].from(e,"hex").toString()}]}function Aa(e){return[{name:"Hardware Revision",raw:e,parsed:Jn["Buffer"].from(e,"hex").toString()}]}function wa(e){return[{name:"Serial Number",raw:e,parsed:Jn["Buffer"].from(e,"hex").toString()}]}function Ta(e){return[{name:"Model Number",raw:e,parsed:Jn["Buffer"].from(e,"hex").toString()}]}function Na(e){return[{name:"Name",raw:e,parsed:Jn["Buffer"].from(e,"hex").toString()}]}var Ra={0:"Unknown",64:"Generic Phone",128:"Generic Computer",192:"Generic Watch",193:"Watch: Sports Watch",256:"Generic Clock",320:"Generic Display",384:"Generic Remote Control",448:"Generic Eye-glasses",512:"Generic Tag",576:"Generic Keyring",640:"Generic Media Player",704:"Generic Barcode Scanner",768:"Generic Thermometer",769:"Thermometer: Ear",832:"Generic Heart rate Sensor",833:"Heart Rate Sensor: Heart Rate Belt",896:"Generic Blood Pressure",897:"Blood Pressure: Arm",898:"Blood Pressure: Wrist",960:"Human Interface Device (HID)",961:"Keyboard",962:"Mouse",963:"Joystick",964:"Gamepad",965:"Digitizer Tablet",966:"Card Reader",967:"Digital Pen",968:"Barcode Scanner",1024:"Generic Glucose Meter",1088:"Generic: Running Walking Sensor",1089:"Running Walking Sensor: In-Shoe",1090:"Running Walking Sensor: On-Shoe",1091:"Running Walking Sensor: On-Hip",1152:"Generic: Cycling",1153:"Cycling: Cycling Computer",1154:"Cycling: Speed Sensor",1155:"Cycling: Cadence Sensor",1156:"Cycling: Power Sensor",1157:"Cycling: Speed and Cadence Sensor",3136:"Generic: Pulse Oximeter",3137:"Fingertip",3138:"Wrist Worn",3200:"Generic: Weight Scale",3264:"Generic Personal Mobility Device",3265:"Powered Wheelchair",3266:"Mobility Scooter",3328:"Generic Continuous Glucose Monitor",3392:"Generic Insulin Pump",3393:"Insulin Pump, durable pump",3396:"Insulin Pump, patch pump",3400:"Insulin Pen",3456:"Generic Medication Delivery",5184:"Generic: Outdoor Sports Activity",5185:"Location Display Device",5186:"Location and Navigation Display Device",5187:"Location Pod",5188:"Location and Navigation Pod"};function xa(e){var t=[];try{var n=Jn["Buffer"].from(e,"hex"),a=n.readUInt16LE(0).toString();t.push({name:"Category",raw:e,parsed:Ra[a]})}catch(r){Kn.error(r)}return t}function Va(e){var t=[];try{var n=Jn["Buffer"].from(e,"hex"),a=1.25*n.readUInt16LE(0);t.push({name:"Minimum Connection Interval",raw:n.slice(0,2).toString("hex"),parsed:65535===a?"no specific minimum":"".concat(a,"ms, [6, 3200]")});var r=1.25*n.readUInt16LE(2);t.push({name:"Maximum Connection Interval",raw:n.slice(2,4).toString("hex"),parsed:65535===r?"no specific minimum":"".concat(a,"ms, [6, 3200]")});var s=n.readUInt16LE(4);t.push({name:"Slave Latency",raw:n.slice(4,6).toString("hex"),parsed:"".concat(s,", [0, 1000]")});var o=n.readUInt16LE(6);t.push({name:"Minimum Connection Interval",raw:n.slice(6,8).toString("hex"),parsed:"".concat(o,", [10, 3200]")})}catch(i){Kn.error(i)}return t}function Ia(e){var t=[];try{var n=Jn["Buffer"].from(e,"hex"),a=n.readUInt16LE(0),r=n.readUInt16LE(2);return[{name:"Start of Affected Attribute Handle Range",raw:n.slice(0,2).toString("hex"),parsed:"".concat(a,", [1, 65535]")},{name:"End of Affected Attribute Handle Range",raw:n.slice(2,4).toString("hex"),parsed:"".concat(r,", [1, 65535]")}]}catch(s){console.error(s)}return t}function La(e,t){return Xn[e]?Xn[e](t):null}var Ea,Pa={getParsedValues:La},Oa=ke.genModuleLogger("operation"),_a=(Ea={},Object(pt["a"])(Ea,Je.operation.READ,Fa),Object(pt["a"])(Ea,Je.operation.NOTIFY,Ma),Object(pt["a"])(Ea,Je.operation.WRITE_NO_RES,Ua),Object(pt["a"])(Ea,Je.operation.WRITE,ka),Ea);function Ma(e,t,n){var a=xt.getDevConf(),r=n.notifyHandle||n.handle,s=n.notifyStatus,o=s===Je.notifyStatus.ON?"0000":"0100";Nn.writeByHandleByDevConf(a,t,r,o,!1).then((function(){n.notifyStatus===Je.notifyStatus.ON?n.notifyStatus=Je.notifyStatus.OFF:n.notifyStatus===Je.notifyStatus.OFF&&(n.notifyStatus=Je.notifyStatus.ON),Yr.notify("下发设备通知 ".concat(t," handle ").concat(r," 成功"),"操作成功",Je.messageType.SUCCESS)})).catch((function(e){Yr.notify("下发设备通知 ".concat(t," handle ").concat(r," 失败: ").concat(e),"操作失败",Je.messageType.ERROR)}))}function Ba(e){return e.trim().split(/\s+/).join("")}function ka(e,t,n){var a=xt.getDevConf(),r=n.handle,s=n.writeValue;n.writeValueType===Je.writeDataType.TEXT&&(s=textToHex(s)),s=Ba(s),Nn.writeByHandleByDevConf(a,t,r,s,!1).then((function(e){Yr.notify("写入设备 ".concat(t," handle ").concat(r," value ").concat(s," 成功"),"操作成功",Je.messageType.SUCCESS)})).catch((function(e){Yr.notify("写入设备 ".concat(t," handle ").concat(r," value ").concat(s," 失败: ").concat(e),"操作失败",Je.messageType.ERROR)}))}function Ua(e,t,n){var a=xt.getDevConf(),r=n.handle,s=n.writeValue;n.writeValueType===Je.writeDataType.TEXT&&(s=qn.a.from(s).toString("hex")),s=Ba(s),Nn.writeByHandleByDevConf(a,t,r,s,!0).then((function(e){Yr.notify("写入设备 ".concat(t," handle ").concat(r," value ").concat(s," 成功"),"操作成功",Je.messageType.SUCCESS)})).catch((function(e){Yr.notify("写入设备 ".concat(t," handle ").concat(r," value ").concat(s," 失败: ").concat(e),"操作失败",Je.messageType.ERROR)}))}function Fa(e,t,n){var a=xt.getDevConf(),r=n.handle;Nn.readByHandleByDevConf(a,t,r).then((function(e){n.readValue=e.value||"No Data",n.parsedReadValues=Pa.getParsedValues(n.name,n.readValue),Yr.notify("读取设备 ".concat(t," handle ").concat(r," 成功"),"操作成功",Je.messageType.SUCCESS)})).catch((function(e){n.readValue="",n.parsedReadValues=[],Yr.notify("读取设备 ".concat(t," handle ").concat(r," 失败: ").concat(e),"操作失败",Je.messageType.ERROR),Oa.error(e)}))}function Wa(e,t,n){var a="no support operation: ".concat(e,", ").concat(t,", ").concat(JSON.stringify(n));return Oa.warn(a),Promise.reject(a)}function ja(e,t,n){var a=_a[e]||Wa;return a(e,t,n)}var za,$a,Ha,Ga,Ja,qa,Ka={dispatch:ja},Xa=n("2ef0"),Ya=(qa={},Object(pt["a"])(qa,Je.apiType.SCAN,(za={},Object(pt["a"])(za,Je.codeType.CURL,nr),Object(pt["a"])(za,Je.codeType.NODEJS,ir),za)),Object(pt["a"])(qa,Je.apiType.CONNECT,($a={},Object(pt["a"])($a,Je.codeType.CURL,tr),Object(pt["a"])($a,Je.codeType.NODEJS,rr),$a)),Object(pt["a"])(qa,Je.apiType.READ,(Ha={},Object(pt["a"])(Ha,Je.codeType.CURL,er),Object(pt["a"])(Ha,Je.codeType.NODEJS,or),Ha)),Object(pt["a"])(qa,Je.apiType.WRITE,(Ga={},Object(pt["a"])(Ga,Je.codeType.CURL,Qa),Object(pt["a"])(Ga,Je.codeType.NODEJS,sr),Ga)),Object(pt["a"])(qa,Je.apiType.DISCONNECT,(Ja={},Object(pt["a"])(Ja,Je.codeType.CURL,Za),Object(pt["a"])(Ja,Je.codeType.NODEJS,ar),Ja)),qa);function Za(e){var t=xt.getDevConf(),n=Nn.getDisconnectUrlByDevConf(t,e.deviceMac);return"\n  curl --location --request DELETE '".concat(n,"'\n  ")}function Qa(e){var t=xt.getDevConf(),n=Nn.getWriteUrlByDevConf(t,e.deviceMac,e.handle,e.value,e.noresponse);return"\n  curl --location --request GET '".concat(n,"'\n  ")}function er(e){var t=xt.getDevConf(),n=Nn.getReadUrlByDevConf(t,e.deviceMac,e.handle);return"\n  curl --location --request GET '".concat(n,"'\n  ")}function tr(e){var t=xt.getDevConf(),n=Nn.getConnectUrlByDevConf(t,e.deviceMac,e.chip);return"\n  curl --location --request POST '".concat(n,'\'   --header \'Content-Type: application/json\'   --data-raw \'{\n    "timeout": 5000,\n    "type": "').concat(e.addrType,"\"\n  }'\n  ")}function nr(e){var t=xt.getDevConf(),n=Xa.cloneDeep(t);Xa.forEach(e,(function(e,t){void 0!==e&&null!==e&&(n[t]=e)}));var a=Nn.getScanUrlByDevConf(n);return'\n  curl -H "Accept: text/event-stream" \''.concat(a,"'\n  ")}function ar(e){var t=xt.getDevConf(),n=Nn.getConnectUrlByDevConf(t,e.deviceMac);return"\n  var request = require('request');\n  var options = {\n    'method': 'DELETE',\n    'url': '".concat(n,"',\n    'headers': {\n    }\n  };\n  request(options, function (error, response) { \n    if (error) throw new Error(error);\n    console.log(response.body);\n  });\n  ")}function rr(e){var t=xt.getDevConf(),n=Nn.getConnectUrlByDevConf(t,e.deviceMac,e.chip);return"\n  var request = require('request');\n  var options = {\n    'method': 'POST',\n    'url': '".concat(n,"',\n    'headers': {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\"timeout\":5000,\"type\":\"").concat(e.addrType,'"})\n\n  };\n  request(options, function (error, response) { \n    if (error) throw new Error(error);\n    console.log(response.body);\n  });\n  ')}function sr(e){var t=xt.getDevConf(),n=Nn.getWriteUrlByDevConf(t,e.deviceMac,e.handle,e.value,e.noresponse);return"\n  var request = require('request');\n  var options = {\n    'method': 'GET',\n    'url': '".concat(n,"',\n    'headers': {\n    }\n  };\n  request(options, function (error, response) { \n    if (error) throw new Error(error);\n    console.log(response.body);\n  });\n  ")}function or(e){var t=xt.getDevConf(),n=Nn.getConnectUrlByDevConf(t,e.deviceMac);return"\n  var request = require('request');\n  var options = {\n    'method': 'GET',\n    'url': '".concat(n,"',\n    'headers': {\n    }\n  };\n  request(options, function (error, response) { \n    if (error) throw new Error(error);\n    console.log(response.body);\n  });\n  ")}function ir(e){var t=xt.getDevConf(),n=Xa.cloneDeep(t);Xa.forEach(e,(function(e,t){void 0!==e&&null!==e&&(n[t]=e)}));var a=Nn.getScanUrlByDevConf(n);return"\n  const EventSource = require('eventsource');\n\n  const url = '".concat(a,"';\n\n  const sse = new EventSource(url);\n\n  sse.onerror = function(error) {\n    console.log('open scan sse failed:', error);\n  };\n\n  sse.onmessage = function(message) {\n    console.log('recevied scan sse message:', message);\n  };\n  ")}function cr(e,t,n){return Ya[e][t](n)}function lr(e,t){var n=xt.getDevConf(),a=Nn.getAsyncConnectUrlByDevConf(n),r=Nn.getConnectStatusUrlByDevConf(n),s=Nn.getScanUrlByUserParams(n,e.chip,e.filter_mac,e.filter_name,e.filter_rssi);return"\n  /**\n   * 1.scanned device -> async connect\n   * 2.connect result reported by connect status sse: \n   *  - connected: connect success, then write data\n   *  - disconnected: device disconnected, if the write is not successful, recall async connect\n   *  - timeout: connect timeout, recall async connect\n   * caution: \n   *  - please confirm AP version support\n   *  - connect status event only triggered when event happened, its means already connected devices before sse created will not trigger connect status event\n   */\n  const request = require('request');\n  const EventSource = require('eventsource');\n  \n  const devicesWriteFlag = {};\n  const devicesInfo = {};\n\n  function openScanSse() {\n    const url = '".concat(s,"';\n    const sse = new EventSource(url);\n\n    sse.onerror = function(error) {\n      console.log('open notify sse failed:', error);\n    };\n    \n    // async connect device when scanned it\n    sse.onmessage = function(message) {\n      // console.log('recevied scan sse message:', message);\n      const data = JSON.parse(message.data);\n      const deviceAddr = data.bdaddrs[0];\n      const deviceMac = deviceAddr.bdaddr;\n      if (devicesWriteFlag[deviceMac]) return;\n      const deviceAddrType = deviceAddr.bdaddrType;\n      console.log('scanned device:', deviceMac, deviceAddrType);\n\n      devicesInfo[deviceMac] = deviceAddrType;\n      connect(deviceMac, deviceAddrType);\n    };\n    \n    return Promise.resolve(sse);\n  }\n\n  // async connect to device\n  function connect(deviceMac, addrType) {\n    let options = {\n      'method': 'POST',\n      'url': '").concat(a,"',\n      'headers': {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\"list\":[{\"type\": addrType,\"addr\": deviceMac}],\"timeout\":5000,\"per_dev_timeout\":10000})\n    };\n\n    // if connect failed, retry when scanned it\n    return new Promise((resolve, reject) => {\n      request(options, function (error, response) { \n        console.log('connect:', error, response.body);\n        if (error) reject(error);\n        else if (response.body !== 'OK') reject(response.body);\n        else resolve(response.body);\n      });\n    });\n  }\n\n  // write data to device\n  function write(deviceMac, handle, value, noresponse=false) {\n    const urlTpl = '").concat(Nn.getWriteUrlByDevConf(n,"#deviceMac","#handle","#value","#noresponse"),"';\n    const url = urlTpl.replace(/#deviceMac/g, deviceMac).replace(/#handle/g, handle).replace(/#value/g, value).replace(/#noresponse/g, noresponse);\n    let options = {\n      'method': 'GET',\n      'url': url,\n      'headers': {}\n    };\n    return new Promise((resolve, reject) => {\n      request(options, function (error, response) { \n        console.log('write:', error, response.body, url);\n        if (error) reject(error);\n        else if (response.body !== 'OK') reject(response.body);\n        else resolve(response.body);\n      });\n    });\n  }\n\n  Promise.wait = function (time) { \n    return new Promise(function (resolve) { \n      return setTimeout(resolve, time || 0); \n    }); \n  }; \n\n  Promise.retry = function (fn, cont, delay, ...p) { \n    return fn(...p).catch(function (err) { \n      return cont > 0 ? Promise.wait(delay).then(function() { \n        return Promise.retry(fn, cont - 1, delay, ...p); \n      }) : Promise.reject('failed'); \n    }); \n  }; \n\n  function openConnectStateSse() {\n    const url = '").concat(r,"';\n    const sse = new EventSource(url);\n\n    sse.onerror = function(error) {\n      console.log('open connect status sse failed:', error);\n    };\n    \n    sse.onmessage = function(message) {\n      console.log('recevied connect status sse message:', message);\n      const data = JSON.parse(message.data);\n      const deviceMac = data.handle;\n      if (devicesWriteFlag[deviceMac]) return;\n      if (data.connectionState === 'connected') {\n        Promise.retry(write, 2, 200, deviceMac, ").concat(t.handle,", '").concat(t.value,"', ").concat(t.noresponse,").then(() => {\n          devicesWriteFlag[deviceMac] = true;\n          Promise.retry(disconnect, 2, 50, deviceMac);\n        }).catch(ex => {\n          console.error(ex);\n        });\n      } else if (data.connectionState === 'disconnected') {\n        // retry connect when scanned\n      } else if (data.connectionState === 'timeout') {\n        // retry connect when scanned\n      }\n    };\n    \n    return Promise.resolve(sse);\n  }\n\n  function disconnect(deviceMac) {\n    const urlTpl = '").concat(Nn.getDisconnectUrlByDevConf(n,"#deviceMac"),"';\n    const url = urlTpl.replace(/#deviceMac/g, deviceMac);\n    let options = {\n      'method': 'DELETE',\n      'url': url,\n      'headers': {\n      }\n    };\n    return new Promise((resolve, reject) => {\n      request(options, function (error, response) { \n        console.log('disconnect:', error, response.body, url);\n        if (error) reject(error);\n        else if (response.body !== 'OK') reject(response.body);\n        else resolve(response.body);\n      });\n    });\n  }\n\n  function main() {\n    openScanSse().then(openConnectStateSse).then(() => {\n      console.log('start success');\n    }).catch(ex => {\n      console.error('start failed:', ex);\n    });\n  }\n\n  main();\n  ")}function pr(e,t){var n=xt.getDevConf(),a=Nn.getOauth2UrlByDevConf(n),r=Nn.getAsyncConnectUrlByDevConf(n,!1),s=Nn.getConnectStatusUrlByDevConf(n,!1),o=Nn.getScanUrlByUserParams(n,e.chip,e.filter_mac,e.filter_name,e.filter_rssi,!1);return"\n  /**\n   * 1.scanned device -> async connect\n   * 2.connect result reported by connect status sse: \n   *  - connected: connect success, then write data\n   *  - disconnected: device disconnected, if the write is not successful, recall async connect\n   *  - timeout: connect timeout, recall async connect\n   * caution: \n   *  - please confirm AC version support\n   *  - connect status event only triggered when event happened, its means already connected devices before sse created will not trigger connect status event\n   */\n  const request = require('request');\n  const EventSource = require('eventsource');\n  \n  const key = '".concat(n.acDevKey,"';\n  const secret = '").concat(n.acDevSecret,"';\n\n  const devicesWriteFlag = {};\n  const devicesInfo = {};\n\n  // oauth2\n  function oauth2(key, secret) {\n    const auth = Buffer.from(`${key}:${secret}`).toString('base64');\n    let options = {\n      'method': 'POST',\n      'url': '").concat(a,"',\n      'headers': {\n        'Authorization': `Basic ${auth}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({'grant_type': 'client_credentials'})\n    };\n    return new Promise((resolve, reject) => {\n      request(options, function (error, response) { \n        console.log('oauth2:', error, response.body);\n        if (error) reject(error);\n        else if (response.statusCode !== 200) reject(response.body);\n        else resolve(JSON.parse(response.body).access_token);\n      });\n    });\n  }\n\n  function openScanSse(token) {\n    const url = `").concat(o,"&access_token=${token}`;\n    const sse = new EventSource(url);\n\n    sse.onerror = function(error) {\n      console.log('open notify sse failed:', error);\n    };\n    \n    // async connect device when scanned it\n    sse.onmessage = function(message) {\n      // console.log('recevied scan sse message:', message);\n      const data = JSON.parse(message.data);\n      const deviceAddr = data.bdaddrs[0];\n      const deviceMac = deviceAddr.bdaddr;\n      if (devicesWriteFlag[deviceMac]) return;\n      const deviceAddrType = deviceAddr.bdaddrType;\n      console.log('scanned device:', deviceMac, deviceAddrType);\n\n      devicesInfo[deviceMac] = deviceAddrType;\n      connect(token, deviceMac, deviceAddrType);\n    };\n    \n    return Promise.resolve(sse);\n  }\n\n  // async connect to device\n  function connect(token, deviceMac, addrType) {\n    let options = {\n      'method': 'POST',\n      'url': `").concat(r,"&access_token=${token}`,\n      'headers': {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\"list\":[{\"type\": addrType,\"addr\": deviceMac}],\"timeout\":5000,\"per_dev_timeout\":10000})\n    };\n\n    // if connect failed, retry when scanned it\n    return new Promise((resolve, reject) => {\n      request(options, function (error, response) { \n        console.log('connect:', error, response.body);\n        if (error) reject(error);\n        else if (response.body !== 'OK') reject(response.body);\n        else resolve(response.body);\n      });\n    });\n  }\n\n  // write data to device\n  function write(token, deviceMac, handle, value, noresponse=false) {\n    const urlTpl = '").concat(Nn.getWriteUrlByDevConf(n,"#deviceMac","#handle","#value","#noresponse",!1),"';\n    let url = urlTpl.replace(/#deviceMac/g, deviceMac).replace(/#handle/g, handle).replace(/#value/g, value).replace(/#noresponse/g, noresponse);\n    url = url + `&access_token=${token}`;\n    let options = {\n      'method': 'GET',\n      'url': url,\n      'headers': {}\n    };\n    return new Promise((resolve, reject) => {\n      request(options, function (error, response) { \n        console.log('write:', error, response.body, url);\n        if (error) reject(error);\n        else if (response.body !== 'OK') reject(response.body);\n        else resolve(response.body);\n      });\n    });\n  }\n\n  Promise.wait = function (time) { \n    return new Promise(function (resolve) { \n      return setTimeout(resolve, time || 0); \n    }); \n  }; \n\n  Promise.retry = function (fn, cont, delay, ...p) { \n    return fn(...p).catch(function (err) { \n      return cont > 0 ? Promise.wait(delay).then(function() { \n        return Promise.retry(fn, cont - 1, delay, ...p); \n      }) : Promise.reject('failed'); \n    }); \n  }; \n\n  function openConnectStateSse(token) {\n    const url = '").concat(s,"' + `&access_token=${token}`;\n    const sse = new EventSource(url);\n\n    sse.onerror = function(error) {\n      console.log('open connect status sse failed:', error);\n    };\n    \n    sse.onmessage = function(message) {\n      console.log('recevied connect status sse message:', message);\n      const data = JSON.parse(message.data);\n      const deviceMac = data.handle;\n      if (devicesWriteFlag[deviceMac]) return;\n      if (data.connectionState === 'connected') {\n        Promise.retry(write, 2, 200, token, deviceMac, ").concat(t.handle,", '").concat(t.value,"', ").concat(t.noresponse,").then(() => {\n          devicesWriteFlag[deviceMac] = true;\n          Promise.retry(disconnect, 2, 50, token, deviceMac);\n        }).catch(ex => {\n          console.error(ex);\n        });\n      } else if (data.connectionState === 'disconnected') {\n        // retry connect when scanned\n      } else if (data.connectionState === 'timeout') {\n        // retry connect when scanned\n      }\n    };\n    \n    return Promise.resolve(sse);\n  }\n\n  function disconnect(token, deviceMac) {\n    const urlTpl = '").concat(Nn.getDisconnectUrlByDevConf(n,"#deviceMac",!1),"';\n    let url = urlTpl.replace(/#deviceMac/g, deviceMac);\n    url = url + `&access_token=${token}`;\n    let options = {\n      'method': 'DELETE',\n      'url': url,\n      'headers': {\n      }\n    };\n    return new Promise((resolve, reject) => {\n      request(options, function (error, response) { \n        console.log('disconnect:', error, response.body, url);\n        if (error) reject(error);\n        else if (response.body !== 'OK') reject(response.body);\n        else resolve(response.body);\n      });\n    });\n  }\n\n  (async () => {\n    try {\n      let token = await oauth2(key, secret);\n      console.log('token:', token);\n      await openScanSse(token);\n      await openConnectStateSse(token);\n      console.log('success');\n    } catch(ex) {\n      console.error('fail:', ex);\n    }\n  })();\n  ")}function ur(e,t){var n=xt.getDevConf(),a=Nn.getConnectUrlByDevConf(n,e.deviceMac,e.chip),r=Nn.getWriteUrlByDevConf(n,e.deviceMac,t.handle,t.value,t.noresponse),s=Nn.getNotifyUrlByDevConf(n);return"\n  const request = require('request');\n  const EventSource = require('eventsource');\n\n  // connect to device\n  function connect() {\n    let options = {\n      'method': 'POST',\n      'url': '".concat(a,"',\n      'headers': {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\"timeout\":5000, \"type\": \"").concat(e.addrType,"\"})\n    };\n    return new Promise((resolve, reject) => {\n      request(options, function (error, response) { \n        console.log('connect:', error, response.body);\n        if (error) reject(error);\n        else if (response.body !== 'OK') reject(response.body);\n        else resolve(response.body);\n      });\n    });\n  }\n\n  // write data to device\n  function write() {\n    let options = {\n      'method': 'GET',\n      'url': '").concat(r,"',\n      'headers': {\n      }\n    };\n    return new Promise((resolve, reject) => {\n      request(options, function (error, response) { \n        console.log('write:', error, response.body);\n        if (error) reject(error);\n        else if (response.body !== 'OK') reject(response.body);\n        else resolve(response.body);\n      });\n    });\n  }\n\n  function openNotifySse() {\n    const url = '").concat(s,"';\n    const sse = new EventSource(url);\n\n    sse.onerror = function(error) {\n      console.log('open notify sse failed:', error);\n    };\n    \n    sse.onmessage = function(message) {\n      console.log('recevied notify sse message:', message);\n    };\n    \n    return Promise.resolve(sse);\n  }\n\n  // TODO: listen connect status sse, add retry when device disconnected\n\n  function main() {\n    connect().then(write).then(openNotifySse).then(() => {\n      console.log('success');\n    }).catch(ex => {\n      console.error('fail:', ex);\n    });\n  }\n\n  main();\n  ")}function dr(e,t){var n=xt.getDevConf(),a=Nn.getOauth2UrlByDevConf(n),r=Nn.getConnectUrlByDevConf(n,e.deviceMac,e.chip,!1),s=Nn.getWriteUrlByDevConf(n,e.deviceMac,t.handle,t.value,t.noresponse,!1),o=Nn.getNotifyUrlByDevConf(n,!1);return"\n  const request = require('request');\n  const EventSource = require('eventsource');\n\n  const key = '".concat(n.acDevKey,"';\n  const secret = '").concat(n.acDevSecret,"';\n\n  // oauth2\n  function oauth2(key, secret) {\n    const auth = Buffer.from(`${key}:${secret}`).toString('base64');\n    let options = {\n      'method': 'POST',\n      'url': '").concat(a,"',\n      'headers': {\n        'Authorization': `Basic ${auth}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({'grant_type': 'client_credentials'})\n    };\n    return new Promise((resolve, reject) => {\n      request(options, function (error, response) { \n        console.log('oauth2:', error, response.body);\n        if (error) reject(error);\n        else if (response.statusCode !== 200) reject(response.body);\n        else resolve(JSON.parse(response.body).access_token);\n      });\n    });\n  }\n\n  // connect to device\n  function connect(token) {\n    let options = {\n      'method': 'POST',\n      'url': `").concat(r,"&access_token=${token}`,\n      'headers': {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\"timeout\":5000, \"type\": \"").concat(e.addrType,"\"})\n    };\n    return new Promise((resolve, reject) => {\n      request(options, function (error, response) { \n        console.log('connect:', error, response.body);\n        if (error) reject(error);\n        else if (response.body !== 'OK') reject(response.body);\n        else resolve(response.body);\n      });\n    });\n  }\n\n  // write data to device\n  function write(token) {\n    let options = {\n      'method': 'GET',\n      'url': `").concat(s,"&access_token=${token}`,\n      'headers': {\n      }\n    };\n    return new Promise((resolve, reject) => {\n      request(options, function (error, response) { \n        console.log('write:', error, response.body);\n        if (error) reject(error);\n        else if (response.body !== 'OK') reject(response.body);\n        else resolve(response.body);\n      });\n    });\n  }\n\n  function openNotifySse(token) {\n    const url = `").concat(o,"&access_token=${token}`;\n    const sse = new EventSource(url);\n\n    sse.onerror = function(error) {\n      console.log('open notify sse failed:', error);\n    };\n    \n    sse.onmessage = function(message) {\n      console.log('recevied notify sse message:', message);\n    };\n    \n    return Promise.resolve(sse);\n  }\n\n  // TODO: listen connect status sse, add retry when device disconnected\n\n  (async () => {\n    try {\n      let token = await oauth2(key, secret);\n      console.log('token:', token);\n      await connect(token);\n      await write(token);\n      await openNotifySse(token);\n      console.log('success');\n    } catch(ex) {\n      console.error('fail:', ex);\n    }\n  })();\n  ")}function fr(e,t){var n=xt.getDevConf();return n.controlStyle===Je.controlStyle.AP?ur(e,t):dr(e,t)}function vr(e,t){var n=xt.getDevConf();return n.controlStyle===Je.controlStyle.AP?lr(e,t):pr(e,t)}var mr={genCode:cr,apiDemoConnectWriteNotifyGenCode:fr,apiDemoScanConnectWriteNotifyGenCode:vr},yr=ke.genModuleLogger("notify"),hr=null;function gr(e){var t=JSON.parse(e.data);yr.info("notify sse message:",e);var n=xt.getCache();n.notifyResultList.push({time:Date.now(),mac:t.id,handle:t.handle,value:t.value})}function Cr(e){yr.error("notify sse error:",e),Yr.notify("关闭设备通知SSE，SSE异常: ".concat(e.message||JSON.stringify(e)),"服务异常",Je.messageType.ERROR),hr.close(),hr=null}function Dr(){if(hr)return hr;var e=xt.getDevConf();hr=Nn.startNotifyByDevConf(e,gr,Cr)}function br(){hr&&(hr.close(),hr=null)}function Sr(){br(),Dr()}var Ar={openNotifySse:Dr,closeNotifySse:br,reopenNotifySse:Sr},wr=n("2ef0"),Tr=ke.genModuleLogger("connect"),Nr=null;function Rr(){var e=xt.getDevConf();Nn.getConnectedListByDevConf(e).then((function(e){var t=xt.getCache();wr.forEach(e.nodes,(function(e){var n=wr.find(t.connectedList,{mac:e.id});n?n.chip=e.chipId:t.connectedList.push({name:e.name||"(unknown)",mac:e.id,bdaddrType:e.type,chip:e.chipId})}))}))}function xr(){var e=xt.getCache(),t=e.connectedList.pop();t&&e.connectedList.push(t)}function Vr(e){var t=xt.getCache(),n=JSON.parse(e.data);if("connected"===n.connectionState)xt.listAddOrUpdate(xt.getCache().connectedList,{mac:n.handle},{mac:n.handle,chip:n.chipId}),Yr.notify("chip".concat(n.chipId," 连接").concat(n.handle,"成功"),"操作成功",Je.messageType.SUCCESS);else if("disconnected"===n.connectionState){var a=wr.findIndex(t.connectedList,{mac:n.handle});if(-1===a)return;t.connectedList.splice(a,1);var r=t.connectedList[a]||t.connectedList[a-1],s=r?r.mac:"0";t.currentConnectedTab=s,xr(),Yr.notify("设备 ".concat(n.handle," 断开连接"),"通知提示",Je.messageType.WARNING)}}function Ir(e){Tr.error("connect status sse error:",e),Yr.notify("关闭连接状态SSE，SSE异常: ".concat(e.message||JSON.stringify(e)),"服务异常",Je.messageType.ERROR),Nr.close(),Nr=null}function Lr(){var e=xt.getDevConf();Nr=Nn.openConnectStatusSseByDevConf(e,Vr,Ir)}function Er(){Nr&&(Nr.close(),Nr=null)}function Pr(){Er(),Lr()}var Or={loadConnectedList:Rr,openConnectStatusSse:Lr,closeConnectStatusSse:Er,reopenConnectStatusSse:Pr},_r=n("2ef0"),Mr=ke.genModuleLogger("vue");function Br(e){return function(){return{chartOptions:jr(),store:xt.getStorage(),cache:xt.getCache()}}}function kr(){document.querySelectorAll("pre code").forEach((function(e){hljs.highlightBlock(e)}))}function Ur(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Je.messageType.INFO;is.getGlobalVue().$message({message:e,type:t,showClose:!0})}function Fr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Je.messageType.INFO,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r={title:t,message:e,type:n};a||(r.duration=0),is.getGlobalVue().$notify(r)}function Wr(){var e=[],t=xt.getDevConfDisplayVars();t.rssiChartDataCount=1e3*t.rssiChartPeriod/t.rssiChartDataSpan;for(var n=0;n<t.rssiChartDataCount;n++)e.push((n*t.rssiChartDataSpan).toString());return e}function jr(){var e=Wr();return{title:{show:!1},autoresize:!0,grid:{},legend:{type:"scroll"},xAxis:{type:"category",data:e,axisLabel:{show:!0,rotate:45,interval:0,formatter:function(e,t){return""}}},yAxis:{type:"value",min:-100,max:-10,splitNumber:10,inverse:!0},series:[]}}function zr(e){return{apiDemoScanChanged:function(e){var t=JSON.parse(e),n=this.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.scan;n.chip=t.data.query.chip,t.data.query.filter_name&&(n.filter_name=t.data.query.filter_name),t.data.query.filter_mac&&(n.filter_mac=t.data.query.filter_mac),n.filter_rssi=t.data.query.filter_rssi},apiDemoScanTest:function(){var e=this.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.scan,t=Nn.startScanByUserParams(this.store.devConf,e.chip,e.filter_mac,e.filter_name,e.filter_rssi,(function(){Fr("测试扫描成功","操作成功",Je.messageType.SUCCESS),t.close()}),(function(e){Fr("测试扫描失败: ".concat(e),"操作失败",Je.messageType.ERROR)}))},apiDemoScanConnectWriteNotifyGenCode:function(){var e=this.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.scan,t=this.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.write,n=mr.apiDemoScanConnectWriteNotifyGenCode(e,t);this.store.devConfDisplayVars.apiDemoParams.scanConnectWriteNotify.code=n},apiDemoConnectWriteNotifyGenCode:function(){var e=this.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.write,t=this.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.connect,n=mr.apiDemoConnectWriteNotifyGenCode(t,e);this.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.code=n},apiDemoWriteChanged:function(e){var t=JSON.parse(e),n=this.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.write;n.handle=t.data.params.handle,n.value=t.data.params.value,n.noresponse=1===_r.get(t,"data.query.noresponse")||!1},apiDemoWriteTest:function(){var e=this.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.write,t=this.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.connect;Nn.writeByHandleByDevConf(this.store.devConf,t.deviceMac,e.handle,e.value,e.noresponse).then((function(){Fr("测试写入数据 ".concat(deviceMac," 成功"),"操作成功",Je.messageType.SUCCESS)})).catch((function(e){Fr("测试写入数据 ".concat(t.deviceMac," 失败: ").concat(e),"操作失败",Je.messageType.ERROR)}))},apiDemoConnectTest:function(){var e=this.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.connect;Nn.connectByDevConf(this.store.devConf,e.deviceMac,e.addrType,e.chip).then((function(){})).catch((function(t){Fr("测试连接设备 ".concat(e.deviceMac," 失败: ").concat(t),"操作失败",Je.messageType.ERROR)}))},apiDemoConnectChanged:function(e){var t=JSON.parse(e),n=this.store.devConfDisplayVars.apiDemoParams.connectWriteNotify.connect;n.chip=t.data.query.chip,n.deviceMac=t.data.params.deviceMac,n.addrType=t.data.body.type},getApiLogListByFilter:function(e){return _r.filter(this.cache.apiLogResultList,e)},getComputedApiLogDisplayResultList:function(){var e=Ae.a.toString(this.cache.apiLogDisplayFilterContent).trim().toLowerCase();if(e){var t=new RegExp(e,"gi"),n=["apiName","method","url","data"],a=this.cache.apiLogResultList.filter((function(t){return n.some((function(n){return Ae.a.toString(t[n]).toLowerCase().indexOf(e)>-1}))}));return a.map((function(e){var a=Object.assign({},e);return n.forEach((function(e){a[e]=Ae.a.toString(a[e]).replace(t,(function(e){return'<span class="keyword-lighten">'.concat(e,"</span>")}))})),a}))}return this.cache.apiLogResultList},getComputedConnectDisplayResultList:function(){var e=Ae.a.toString(this.cache.connectDisplayFilterContent).trim().toLowerCase();if(e){var t=new RegExp(e,"gi"),n=["mac","name"],a=this.cache.connectedList.filter((function(t){return n.some((function(n){return Ae.a.toString(t[n]).toLowerCase().indexOf(e)>-1}))}));return a.map((function(e){var a=Object.assign({},e);return n.forEach((function(e){a[e]=Ae.a.toString(a[e]).replace(t,(function(e){return'<span class="keyword-lighten">'.concat(e,"</span>")}))})),a}))}return this.cache.connectedList},connectTabsClick:function(){this.connectVuxTableForceResize()},scanTabsClick:function(){this.scanVuxTableForceResize()},scanDisplayResultClear:function(){this.cache.scanDisplayResultList.splice(0)},notifyDisplayResultClear:function(){this.cache.notifyDisplayResultList.splice(0)},apiLogDisplayResultClear:function(){this.cache.apiLogResultList.splice(0)},scanDisplayResultExport:function(){this.$refs.refScanDisplayResultGrid.exportData({type:"csv"})},connectDisplayResultExport:function(){this.$refs.refConnectDisplayResultGrid.exportData({type:"csv"})},notifyDisplayResultExport:function(){this.$refs.refNotifyDisplayResultGrid.exportData({type:"csv"})},apiLogDisplayResultExport:function(){this.$refs.refApiLogDisplayResultGrid.exportData({type:"csv"})},loadNotifyResult:function(){var e=5;this.cache.isNotifyLoading=!0;var t=this.cache.notifyResultList.splice(0,e),n=_r.map(t,(function(e){return"".concat(new Date(e.time).toISOString(),": ").concat(e.data)}));if(0!==t.length){var a,r=this.cache.notifyDisplayResultList.length;(a=this.cache.notifyDisplayResultList).splice.apply(a,[r,n.length].concat(Object(Oe["a"])(n))),this.cache.isNotifyLoading=!1}else setTimeout((function(e){e.cache.isNotifyLoading=!1,e.loadNotifyResult()}),500,this)},loadApiDebuggerResult:function(){var e=this.store.devConfDisplayVars.activeApiTabName;if(e===Je.apiType.SCAN){var t=5;this.cache.isApiDebuggerLoading=!0;var n=this.cache.apiDebuggerResult[Je.apiType.SCAN].resultList.splice(0,t),a=_r.map(n,(function(e){return"".concat(new Date(e.time).toISOString(),": ").concat(e.data)}));if(0!==n.length){var r,s=this.cache.apiDebuggerResult[Je.apiType.SCAN].displayResultList.length;(r=this.cache.apiDebuggerResult[Je.apiType.SCAN].displayResultList).splice.apply(r,[s,a.length].concat(Object(Oe["a"])(a))),this.cache.isApiDebuggerLoading=!1}else setTimeout((function(e){e.cache.isApiDebuggerLoading=!1,e.loadApiDebuggerResult()}),500,this)}},startDebugApi:function(){var e=this,t=this.store.devConfDisplayVars.activeApiTabName,n=this.store.devConfDisplayVars.apiDebuggerParams[t],a=this.cache.apiDebuggerResult[t];t===Je.apiType.SCAN?(a.sse=Nn.startScanByUserParams(this.store.devConf,n.chip,n.filter_mac,n.filter_name,n.filter_rssi,(function(t){e.store.devConfDisplayVars.isApiScanResultDisplayOn&&e.cache.apiDebuggerResult[Je.apiType.SCAN].resultList.push({time:Date.now(),data:t.data.trim()})})),setTimeout((function(){a.sse&&(a.sse.close(),a.sse=null,e.store.devConfDisplayVars.isApiScanning=!1,Fr("已自动停止API扫描","操作成功",Je.messageType.SUCCESS))}),1e4),this.store.devConfDisplayVars.isApiScanning=!0,this.store.devConfDisplayVars.activeApiOutputTabName="output",Fr("调试API扫描自动执行10秒，正常的SSE会一直收到数据","操作成功",Je.messageType.SUCCESS)):t===Je.apiType.CONNECT?Nn.connectByDevConf(this.store.devConf,n.deviceMac,n.addrType,n.chip).then((function(){a.resultList.push("".concat((new Date).toISOString(),": 连接设备成功, ").concat(JSON.stringify(n)))})).catch((function(e){Fr("连接设备 ".concat(n.deviceMac," 失败: ").concat(e),"操作失败",Je.messageType.ERROR),a.resultList.push("".concat((new Date).toISOString(),": 连接设备失败, ").concat(JSON.stringify({apiParams:n,ex:e})))})):t===Je.apiType.READ?Nn.readByHandleByDevConf(this.store.devConf,n.deviceMac,n.handle).then((function(){Fr("读取数据 ".concat(n.deviceMac," 成功"),"操作成功",Je.messageType.SUCCESS),a.resultList.push("".concat((new Date).toISOString(),": 读取数据成功, ").concat(JSON.stringify(n)))})).catch((function(e){Fr("读取数据 ".concat(n.deviceMac," 失败: ").concat(e),"操作失败",Je.messageType.ERROR),a.resultList.push("".concat((new Date).toISOString(),": 读取数据失败, ").concat(JSON.stringify({apiParams:n,ex:e})))})):t===Je.apiType.WRITE?Nn.writeByHandleByDevConf(this.store.devConf,n.deviceMac,n.handle,n.value,n.noresponse).then((function(){Fr("写入数据 ".concat(n.deviceMac," 成功"),"操作成功",Je.messageType.SUCCESS),a.resultList.push("".concat((new Date).toISOString(),": 写入数据成功, ").concat(JSON.stringify(n)))})).catch((function(e){Fr("写入数据 ".concat(n.deviceMac," 失败: ").concat(e),"操作失败",Je.messageType.ERROR),a.resultList.push("".concat((new Date).toISOString(),": 写入数据失败, ").concat(JSON.stringify({apiParams:n,ex:e})))})):t===Je.apiType.DISCONNECT&&Nn.disconnectByDevConf(this.store.devConf,n.deviceMac).then((function(){Fr("断连设备 ".concat(n.deviceMac," 成功"),"操作成功",Je.messageType.SUCCESS),a.resultList.push("".concat((new Date).toISOString(),": 断连设备成功, ").concat(JSON.stringify(n)))})).catch((function(e){Fr("断连设备 ".concat(n.deviceMac," 失败: ").concat(e),"操作失败",Je.messageType.ERROR),a.resultList.push("".concat((new Date).toISOString(),": 断连设备失败, ").concat(JSON.stringify({apiParams:n,ex:e})))}))},openApiOutputDisplay:function(){this.store.devConfDisplayVars.isApiScanResultDisplayOn=!0,Fr("开启API结果成功","操作成功",Je.messageType.SUCCESS)},closeApiOutputDisplay:function(){this.store.devConfDisplayVars.isApiScanResultDisplayOn=!1,Fr("关闭API结果成功","操作成功",Je.messageType.SUCCESS)},exportApiOutputDisplay:function(){Fr("功能待添加","操作失败",Je.messageType.ERROR)},clearApiOutputDisplay:function(){var e=this.store.devConfDisplayVars.activeApiTabName;e===Je.apiType.SCAN&&this.cache.apiDebuggerResult[this.store.devConfDisplayVars.activeApiTabName].displayResultList.splice(0),this.cache.apiDebuggerResult[this.store.devConfDisplayVars.activeApiTabName].resultList.splice(0),Fr("清除API结果成功","操作成功",Je.messageType.SUCCESS)},clearNotify:function(){this.cache.notifyResultList.splice(0),this.cache.notifyDisplayResultList.splice(0),Fr("清除Notify成功","操作成功",Je.messageType.SUCCESS)},openNotify:function(){Ar.openNotifySse(),this.store.devConfDisplayVars.isNotifyOn=!0,Fr("开启Notify成功","操作成功",Je.messageType.SUCCESS)},closeNotify:function(){Ar.closeNotifySse(),this.store.devConfDisplayVars.isNotifyOn=!1,Fr("关闭Notify成功","操作成功",Je.messageType.SUCCESS)},stopRssiChart:function(){clearInterval(this.rssiChartUpdateInterval),this.rssiChartUpdateInterval=null,this.store.devConfDisplayVars.rssiChartStopped=!0},startRssiChart:function(){this.rssiChartUpdateInterval=Hr(this),this.store.devConfDisplayVars.rssiChartStopped=!1},destoryRssiChart:function(){clearInterval(this.rssiChartUpdateInterval),this.rssiChartUpdateInterval=null,this.store.devConfDisplayVars.rssiChartSwitch=!1},destoryAndCreateRssiChart:function(){var e=this;this.store.devConfDisplayVars.isScanning?(this.destoryRssiChart(),setTimeout((function(e){e.chartOptions=jr(),e.startRssiChart(),Fr("开启RSSI图表成功","操作成功",Je.messageType.SUCCESS)}),100,this),this.store.devConfDisplayVars.rssiChartSwitch=!0):this.$confirm("此操作需要开启扫描, 是否继续?（请配置合适的扫描过滤参数，不超过5个设备，否则会自动暂停）","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.startScan(),e.destoryRssiChart(),setTimeout((function(e){e.chartOptions=jr(),e.startRssiChart(),Fr("开启RSSI图表成功","操作成功",Je.messageType.SUCCESS)}),100,e),e.store.devConfDisplayVars.rssiChartSwitch=!0})).catch((function(){}))},connectedListTabRemove:function(e){"invalidDeviceMac"!==e&&this.disconnectDevice(e)},rssiChartDataSpanChange:function(){this.devConfDisplayVars.rssiChartSwitch&&this.destoryAndCreateRssiChart()},genCode:function(){var e=this.store.devConfDisplayVars.activeApiTabName,t=this.store.devConfDisplayVars.apiDebuggerParams[e],n=this.cache.apiDebuggerResult[e];n.code[Je.codeType.CURL]=mr.genCode(e,Je.codeType.CURL,t),n.code[Je.codeType.NODEJS]=mr.genCode(e,Je.codeType.NODEJS,t),this.store.devConfDisplayVars.activeApiOutputTabName=Je.codeType.CURL},menuSelect:function(e,t){"connectListMenuItem"===e?(this.store.devConfDisplayVars.activeMenuItem=e,Or.loadConnectedList(),Or.reopenConnectStatusSse(),this.connectVuxTableForceResize()):"notifyListMenuItem"===e?(this.store.devConfDisplayVars.activeMenuItem=e,this.notifyVuxTableForceResize()):"scanListMenuItem"===e?(this.store.devConfDisplayVars.activeMenuItem=e,this.scanVuxTableForceResize()):"configMenuItem"===e?(this.store.devConfDisplayVars.isConfigMenuItemOpen?(this.store.devConfDisplayVars.isConfigMenuItemOpen=!1,this.store.devConfDisplayVars.mainWidth=24):(this.store.devConfDisplayVars.isConfigMenuItemOpen=!0,this.store.devConfDisplayVars.mainWidth=18),this.scanVuxTableForceResize(),this.notifyVuxTableForceResize(),this.connectVuxTableForceResize(),this.apiLogVuxTableForceResize()):"apiDebuggerMenuItem"===e?this.store.devConfDisplayVars.activeMenuItem=e:"apiLogListMenuItem"===e?(this.store.devConfDisplayVars.activeMenuItem=e,this.apiLogVuxTableForceResize()):"apiDemoMenuItem"===e&&(this.store.devConfDisplayVars.activeMenuItem=e)},apiLogVuxTableForceResize:function(){var e=this.cache.apiLogResultList.pop();e&&this.cache.apiLogResultList.push(e)},connectVuxTableForceResize:function(){var e=this.cache.connectedList.pop();e&&this.cache.connectedList.push(e)},scanVuxTableForceResize:function(){var e=this.cache.scanDisplayResultList.pop();e&&this.cache.scanDisplayResultList.push(e)},notifyVuxTableForceResize:function(){var e=this.cache.notifyDisplayResultList.pop();e&&this.cache.notifyDisplayResultList.push(e)},propertyClick:function(e,t,n){Ka.dispatch(e,t,n)},getDeviceServices:function(e){var t=this;Gn.getDeviceServiceList(e).then((function(){t.cache.currentConnectedTab=e}))},exportDeviceServices:function(e){Gn.getDeviceServiceList(e).then((function(t){t=JSON.stringify(t,null,2);var n=new Blob([t],{type:"text/json"}),a=document.createEvent("MouseEvents"),r=document.createElement("a");r.download="".concat(e.replace(/:/g,"_"),"_service.json"),r.href=window.URL.createObjectURL(n),r.dataset.downloadurl=["text/json",r.download,r.href].join(":"),a.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(a)}))},startScan:function(){On.startScan(this.store.devConf),this.store.devConfDisplayVars.isScanning=!0,this.cache.scanResultList.splice(0),this.cache.scanDisplayResultList.splice(0),this.cache.scanDevicesRssiHistory={},this.store.devConfDisplayVars.activeMenuItem="scanListMenuItem",Fr("开启扫描成功","操作成功",Je.messageType.SUCCESS)},stopApiScan:function(){var e=this.store.devConfDisplayVars.activeApiTabName,t=this.cache.apiDebuggerResult[e];t.sse&&(t.sse.close(),t.sse=null,this.store.devConfDisplayVars.isApiScanning=!1,Fr("已自动停止API扫描","操作成功",Je.messageType.SUCCESS))},stopScan:function(){On.stopScan(),this.store.devConfDisplayVars.rssiChartSwitch&&this.stopRssiChart(),this.store.devConfDisplayVars.isScanning=!1},connectDeviceByRow:function(e,t){var n=this;is.setObjProperty(this.cache.devicesConnectLoading,t,!0),Nn.connectByDevConf(this.store.devConf,t).then((function(){_r.remove(n.cache.scanResultList,{mac:t});var a=_r.remove(n.cache.scanDisplayResultList,{mac:t});n.$refs.refScanDisplayResultGrid.remove([e]),n.$refs.refScanDisplayResultGrid.refreshData(),n.$refs.refScanDisplayResultGrid.recalculate(),n.$refs.refScanDisplayResultGrid.refreshScroll(),a.length>0&&xt.listAddOrUpdate(n.cache.connectedList,{mac:a[0].mac},{mac:a[0].mac,name:a[0].name,bdaddrType:a[0].bdaddrType})})).catch((function(e){Fr("连接设备 ".concat(t," 失败: ").concat(e),"操作失败",Je.messageType.ERROR)})).then((function(){is.setObjProperty(n.cache.devicesConnectLoading,t,!1)}))},disconnectDevice:function(e){var t=this;Nn.disconnectByDevConf(this.store.devConf,e).then((function(){var n=_r.findIndex(t.cache.connectedList,{mac:e});if(-1!==n){t.cache.connectedList.splice(n,1);var a=t.cache.connectedList[n]||t.cache.connectedList[n-1],r=a?a.mac:"0";t.cache.currentConnectedTab=r,t.connectVuxTableForceResize()}})).catch((function(t){Fr("设备 ".concat(e," 断连失败: ").concat(t),"操作失败",Je.messageType.ERROR)}))},apiScanFilterNamesHandleClose:function(e){var t=this.store.devConfDisplayVars.apiDebuggerParams[Je.apiType.SCAN].filter_name;t.splice(t.indexOf(e),1)},apiScanFilterNamesShowInput:function(){var e=this;this.store.devConfDisplayVars.apiScanFilterNamesInputVisible=!0,this.$nextTick((function(t){e.$refs.apiScanFilterNamesSaveTagInput.$refs.input.focus()}))},apiScanFilterNamesHandleInputConfirm:function(){var e=this.store.devConfDisplayVars.apiScanFilterNamesInputValue;e&&this.store.devConfDisplayVars.apiDebuggerParams[Je.apiType.SCAN].filter_name.push(e),this.store.devConfDisplayVars.apiScanFilterNamesInputVisible=!1,this.store.devConfDisplayVars.apiScanFilterNamesInputValue=""},apiScanFilterMacsHandleClose:function(e){var t=this.store.devConfDisplayVars.apiDebuggerParams[Je.apiType.SCAN].filter_mac;t.splice(t.indexOf(e),1)},apiScanFilterMacsShowInput:function(){var e=this;this.store.devConfDisplayVars.apiScanFilterMacsInputVisible=!0,this.$nextTick((function(t){e.$refs.apiScanFilterMacsSaveTagInput.$refs.input.focus()}))},apiScanFilterMacsHandleInputConfirm:function(){var e=this.store.devConfDisplayVars.apiScanFilterMacsInputValue;e&&this.store.devConfDisplayVars.apiDebuggerParams[Je.apiType.SCAN].filter_mac.push(e),this.store.devConfDisplayVars.apiScanFilterMacsInputVisible=!1,this.store.devConfDisplayVars.apiScanFilterMacsInputValue=""},scanFilterNamesHandleClose:function(e){this.store.devConf.filter_name.splice(this.store.devConf.filter_name.indexOf(e),1)},scanFilterNamesShowInput:function(){var e=this;this.store.devConfDisplayVars.scanFilterNamesInputVisible=!0,this.$nextTick((function(t){e.$refs.scanFilterNamesSaveTagInput.$refs.input.focus()}))},scanFilterNamesHandleInputConfirm:function(){var e=this.store.devConfDisplayVars.scanFilterNamesInputValue;e&&this.store.devConf.filter_name.push(e),this.store.devConfDisplayVars.scanFilterNamesInputVisible=!1,this.store.devConfDisplayVars.scanFilterNamesInputValue=""},scanFilterMacsHandleClose:function(e){this.store.devConf.filter_mac.splice(this.store.devConf.filter_mac.indexOf(e),1)},scanFilterMacsShowInput:function(){var e=this;this.store.devConfDisplayVars.scanFilterMacsInputVisible=!0,this.$nextTick((function(t){e.$refs.scanFilterMacsSaveTagInput.$refs.input.focus()}))},scanFilterMacsHandleInputConfirm:function(){var e=this.store.devConfDisplayVars.scanFilterMacsInputValue;e&&this.store.devConf.filter_mac.push(e),this.store.devConfDisplayVars.scanFilterMacsInputVisible=!1,this.store.devConfDisplayVars.scanFilterMacsInputValue=""}}}function $r(e,t,n){var a=[],r=xt.getDevConfDisplayVars();r.rssiChartDataCount=1e3*r.rssiChartPeriod/r.rssiChartDataSpan;var s=_r.keys(xt.getCache().scanDevicesRssiHistory).length;return s>5?(n.destoryRssiChart(),Fr("当前扫描设备数量超过5个，已自动关闭rssi图表，请配置合适的扫描过滤参数，防止卡顿","操作失败",Je.messageType.ERROR),Mr.info("11111111111111",s),[]):(_r.forEach(xt.getCache().scanDevicesRssiHistory,(function(n,s){var o=new Array(r.rssiChartDataCount);_r.remove(n,(function(t){return t.time<e})),_r.forEach(n,(function(n){if(n.time>=e&&n.time<t){var a=parseInt((n.time-e)/r.rssiChartDataSpan);o[a]=n.rssi}})),a.push({name:s,type:"line",data:o})})),a)}function Hr(e){var t=xt.getDevConfDisplayVars();return setInterval((function(e){var n;Mr.info("update rssi chart by interval");var a=Date.now(),r=a-1e3*t.rssiChartPeriod,s=$r(r,a,e);e.chartOptions.series.splice(0),(n=e.chartOptions.series).splice.apply(n,[0,s.length].concat(Object(Oe["a"])(s)))}),t.rssiChartDataSpan,e)}function Gr(){return{"cache.apiDebuggerResult.scanCodeCurl":function(e,t){kr()},"store.devConf":{handler:function(e,t){xt.saveDevConf(e)},deep:!0}}}function Jr(){return{getComputedNotifyDisplayResultList:function(){var e=Ae.a.toString(this.cache.notifyDisplayFilterContent).trim().toLowerCase();if(e){var t=new RegExp(e,"gi"),n=["mac","name"],a=this.cache.notifyDisplayResultList.filter((function(t){return n.some((function(n){return Ae.a.toString(t[n]).toLowerCase().indexOf(e)>-1}))}));return a.map((function(e){var a=Object.assign({},e);return n.forEach((function(e){a[e]=Ae.a.toString(a[e]).replace(t,(function(e){return'<span class="keyword-lighten">'.concat(e,"</span>")}))})),a}))}return this.cache.notifyDisplayResultList},getComputedScanDisplayResultList:function(){var e=Ae.a.toString(this.cache.scanDisplayFilterContent).trim().toLowerCase();if(e){var t=new RegExp(e,"gi"),n=["mac","name"],a=this.cache.scanDisplayResultList.filter((function(t){return n.some((function(n){return Ae.a.toString(t[n]).toLowerCase().indexOf(e)>-1}))}));return a.map((function(e){var a=Object.assign({},e);return n.forEach((function(e){a[e]=Ae.a.toString(a[e]).replace(t,(function(e){return'<span class="keyword-lighten">'.concat(e,"</span>")}))})),a}))}return this.cache.scanDisplayResultList}}}function qr(){setInterval((function(){var e=20,t=xt.getCache().scanResultList.splice(0,e);!t||t.length<=0||_r.forEach(t,(function(e){var t=_r.find(xt.getCache().scanDisplayResultList,{mac:e.mac});t?(t.rssi=e.rssi,"(unknown)"===t.name&&(t.name=e.name)):xt.getCache().scanDisplayResultList.push(e)}))}),500)}function Kr(){setInterval((function(){var e,t=20,n=xt.getCache().notifyResultList.splice(0,t);if(n&&!(n.length<=0)){var a=xt.getCache().notifyDisplayResultList.length;(e=xt.getCache().notifyDisplayResultList).splice.apply(e,[a,n.length].concat(Object(Oe["a"])(n)))}}),500)}function Xr(){return qr(),Kr(),{data:Br(),computed:Jr(),methods:zr(),watch:Gr()}}var Yr={notify:Fr,createVue:Xr,message:Ur},Zr=Yr.createVue(),Qr=Zr,es=(n("034f"),n("2877")),ts=Object(es["a"])(Qr,Ee,Pe,!1,null,null,null),ns=ts.exports,as=null;function rs(){a["default"].use(Te.a),a["default"].use(Ne["a"],{languages:{javascript:Ie.a,bash:xe.a}}),a["default"].component("v-chart",Le["a"])}function ss(){return as}function os(e,t,n){ss().$set(e,t,n)}(function(){rs(),as=new a["default"]({el:"#app",render:function(e){return e(ns)}})})();var is=t["default"]={getGlobalVue:ss,setObjProperty:os}},"85ec":function(e,t,n){}});
//# sourceMappingURL=index.bd5fd262.js.map